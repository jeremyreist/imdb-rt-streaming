{"version":3,"file":"main.js","mappings":";;;;;;;AAAa;AACb;AACA,4BAA4B,+DAA+D,iBAAiB;AAC5G;AACA,oCAAoC,MAAM,+BAA+B,YAAY;AACrF,mCAAmC,MAAM,mCAAmC,YAAY;AACxF,gCAAgC;AAChC;AACA,KAAK;AACL;AACA;AACA,cAAc,6BAA6B,0BAA0B,cAAc,qBAAqB;AACxG,iBAAiB,oDAAoD,qEAAqE,cAAc;AACxJ,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC,mCAAmC,SAAS;AAC5C,mCAAmC,WAAW,UAAU;AACxD,0CAA0C,cAAc;AACxD;AACA,8GAA8G,OAAO;AACrH,iFAAiF,iBAAiB;AAClG,yDAAyD,gBAAgB,QAAQ;AACjF,+CAA+C,gBAAgB,gBAAgB;AAC/E;AACA,kCAAkC;AAClC;AACA;AACA,UAAU,YAAY,aAAa,SAAS,UAAU;AACtD,oCAAoC,SAAS;AAC7C;AACA;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,eAAe,mBAAO,CAAC,GAAiB;AACxC,gBAAgB,mBAAO,CAAC,GAAiB;AACzC,YAAY,mBAAO,CAAC,GAAa;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,sCAAsC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,4BAA4B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AC3Ma;AACb;AACA,4BAA4B,+DAA+D,iBAAiB;AAC5G;AACA,oCAAoC,MAAM,+BAA+B,YAAY;AACrF,mCAAmC,MAAM,mCAAmC,YAAY;AACxF,gCAAgC;AAChC;AACA,KAAK;AACL;AACA;AACA,cAAc,6BAA6B,0BAA0B,cAAc,qBAAqB;AACxG,iBAAiB,oDAAoD,qEAAqE,cAAc;AACxJ,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC,mCAAmC,SAAS;AAC5C,mCAAmC,WAAW,UAAU;AACxD,0CAA0C,cAAc;AACxD;AACA,8GAA8G,OAAO;AACrH,iFAAiF,iBAAiB;AAClG,yDAAyD,gBAAgB,QAAQ;AACjF,+CAA+C,gBAAgB,gBAAgB;AAC/E;AACA,kCAAkC;AAClC;AACA;AACA,UAAU,YAAY,aAAa,SAAS,UAAU;AACtD,oCAAoC,SAAS;AAC7C;AACA;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,yBAAyB,GAAG,6BAA6B;AACzD,cAAc,mBAAO,CAAC,GAAmB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,eAAe;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,KAAK,EAAE,EAAwB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,gDAAgD;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6GAA6G;AAC7G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,wEAAwE;AACtH;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACtIa;AACb;AACA,4BAA4B,+DAA+D,iBAAiB;AAC5G;AACA,oCAAoC,MAAM,+BAA+B,YAAY;AACrF,mCAAmC,MAAM,mCAAmC,YAAY;AACxF,gCAAgC;AAChC;AACA,KAAK;AACL;AACA;AACA,cAAc,6BAA6B,0BAA0B,cAAc,qBAAqB;AACxG,iBAAiB,oDAAoD,qEAAqE,cAAc;AACxJ,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC,mCAAmC,SAAS;AAC5C,mCAAmC,WAAW,UAAU;AACxD,0CAA0C,cAAc;AACxD;AACA,8GAA8G,OAAO;AACrH,iFAAiF,iBAAiB;AAClG,yDAAyD,gBAAgB,QAAQ;AACjF,+CAA+C,gBAAgB,gBAAgB;AAC/E;AACA,kCAAkC;AAClC;AACA;AACA,UAAU,YAAY,aAAa,SAAS,UAAU;AACtD,oCAAoC,SAAS;AAC7C;AACA;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,uBAAuB,GAAG,sBAAsB,GAAG,0BAA0B,GAAG,qBAAqB;AACrG,cAAc,mBAAO,CAAC,GAAmB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,eAAe;AAClF;AACA;AACA;AACA;AACA;AACA,2FAA2F,yBAAyB,kBAAkB,oBAAoB,iBAAiB,uBAAuB,mBAAmB;AACrN;AACA;AACA;AACA,wBAAwB,KAAK,EAAE,EAAwB;AACvD;AACA;AACA;AACA;AACA;AACA,oCAAoC,iCAAiC;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,gDAAgD;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,wEAAwE;AACtH;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA,mEAAmE,eAAe;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2FAA2F,yBAAyB,kBAAkB,oBAAoB,iBAAiB,uBAAuB,kBAAkB;AACpN;AACA;AACA;AACA;AACA,wCAAwC,0CAA0C;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,iCAAiC,yBAAyB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;;;;;;;;ACxPV;AACb;AACA,4BAA4B,+DAA+D,iBAAiB;AAC5G;AACA,oCAAoC,MAAM,+BAA+B,YAAY;AACrF,mCAAmC,MAAM,mCAAmC,YAAY;AACxF,gCAAgC;AAChC;AACA,KAAK;AACL;AACA;AACA,cAAc,6BAA6B,0BAA0B,cAAc,qBAAqB;AACxG,iBAAiB,oDAAoD,qEAAqE,cAAc;AACxJ,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC,mCAAmC,SAAS;AAC5C,mCAAmC,WAAW,UAAU;AACxD,0CAA0C,cAAc;AACxD;AACA,8GAA8G,OAAO;AACrH,iFAAiF,iBAAiB;AAClG,yDAAyD,gBAAgB,QAAQ;AACjF,+CAA+C,gBAAgB,gBAAgB;AAC/E;AACA,kCAAkC;AAClC;AACA;AACA,UAAU,YAAY,aAAa,SAAS,UAAU;AACtD,oCAAoC,SAAS;AAC7C;AACA;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,6BAA6B,GAAG,2BAA2B,GAAG,0BAA0B,GAAG,4BAA4B,GAAG,yBAAyB;AACnJ,cAAc,mBAAO,CAAC,GAAmB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,gDAAgD;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,wEAAwE;AACtH;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,4BAA4B;AAC/F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,eAAe;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;;;;;;;;ACjNhB;AACb;AACA;AACA,iDAAiD,OAAO;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,+DAA+D,iBAAiB;AAC5G;AACA,oCAAoC,MAAM,+BAA+B,YAAY;AACrF,mCAAmC,MAAM,mCAAmC,YAAY;AACxF,gCAAgC;AAChC;AACA,KAAK;AACL;AACA;AACA,cAAc,6BAA6B,0BAA0B,cAAc,qBAAqB;AACxG,iBAAiB,oDAAoD,qEAAqE,cAAc;AACxJ,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC,mCAAmC,SAAS;AAC5C,mCAAmC,WAAW,UAAU;AACxD,0CAA0C,cAAc;AACxD;AACA,8GAA8G,OAAO;AACrH,iFAAiF,iBAAiB;AAClG,yDAAyD,gBAAgB,QAAQ;AACjF,+CAA+C,gBAAgB,gBAAgB;AAC/E;AACA,kCAAkC;AAClC;AACA;AACA,UAAU,YAAY,aAAa,SAAS,UAAU;AACtD,oCAAoC,SAAS;AAC7C;AACA;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,oBAAoB,GAAG,iBAAiB,GAAG,aAAa,GAAG,kBAAkB;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,mCAAmC;AAC/E;AACA,aAAa;AACb;AACA,4BAA4B;AAC5B,mCAAmC;AACnC;AACA;AACA,gNAAgN,WAAW,+CAA+C,aAAa,iDAAiD,KAAK,2BAA2B,yBAAyB,mBAAmB,oBAAoB,iCAAiC,oCAAoC,yBAAyB,KAAK,2BAA2B,qDAAqD,iBAAiB,sBAAsB,4CAA4C,kBAAkB,mBAAmB,4BAA4B,uBAAuB,KAAK,uBAAuB,kBAAkB,mBAAmB,yBAAyB,2CAA2C,kCAAkC,+BAA+B,yBAAyB,4BAA4B,0BAA0B,uBAAuB,oBAAoB,8BAA8B,KAAK;AACzmC,sEAAsE;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,oBAAoB;;;;;;;UClMpB;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;UEtBA;UACA;UACA;UACA","sources":["webpack://imdb-rt-streaming/./src/index.ts","webpack://imdb-rt-streaming/./src/sites/disney+/index.ts","webpack://imdb-rt-streaming/./src/sites/hbo/index.ts","webpack://imdb-rt-streaming/./src/sites/netflix/index.ts","webpack://imdb-rt-streaming/./src/utils/utils.ts","webpack://imdb-rt-streaming/webpack/bootstrap","webpack://imdb-rt-streaming/webpack/before-startup","webpack://imdb-rt-streaming/webpack/startup","webpack://imdb-rt-streaming/webpack/after-startup"],"sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar disney_1 = require(\"./sites/disney+\");\nvar netflix_1 = require(\"./sites/netflix\");\nvar hbo_1 = require(\"./sites/hbo\");\nvar StreamingSite;\n(function (StreamingSite) {\n    StreamingSite[StreamingSite[\"Netflix\"] = 0] = \"Netflix\";\n    StreamingSite[StreamingSite[\"DisneyPlus\"] = 1] = \"DisneyPlus\";\n    StreamingSite[StreamingSite[\"HBOMax\"] = 2] = \"HBOMax\";\n    StreamingSite[StreamingSite[\"None\"] = 3] = \"None\";\n})(StreamingSite || (StreamingSite = {}));\nvar PageType;\n(function (PageType) {\n    PageType[PageType[\"Homepage\"] = 0] = \"Homepage\";\n    PageType[PageType[\"Details\"] = 1] = \"Details\";\n    PageType[PageType[\"Watching\"] = 2] = \"Watching\";\n    PageType[PageType[\"None\"] = 3] = \"None\";\n})(PageType || (PageType = {}));\n// clear stored ratings \nchrome.storage.local.clear();\nvar currSite = StreamingSite.None;\nvar oldHref = document.location.href;\nvar lastViewedTitleHref = null;\nwindow.addEventListener(\"load\", onLoad);\nfunction onLoad(event) {\n    // Determine what streaming site we are on\n    if (window.location.href.indexOf(\"netflix.com/\") > -1) {\n        currSite = StreamingSite.Netflix;\n        window.addEventListener(\"mousedown\", function () {\n            if ((0, netflix_1.getNetflixTitleHref)()) {\n                lastViewedTitleHref = (0, netflix_1.getNetflixTitleHref)();\n            }\n        });\n        if (window.location.href.indexOf(\"title\") > -1) {\n            (0, netflix_1.onNetflixDetailsPage)();\n        }\n    }\n    else if (window.location.href.indexOf(\"disneyplus.com/\") > -1) {\n        currSite = StreamingSite.DisneyPlus;\n    }\n    else if (window.location.href.indexOf(\"hbomax.com/\") > -1) {\n        currSite = StreamingSite.HBOMax;\n        window.addEventListener(\"mousedown\", function () {\n            if ((0, hbo_1.getHBOTitleHref)()) {\n                lastViewedTitleHref = (0, hbo_1.getHBOTitleHref)();\n            }\n        });\n    }\n    // Start observing the DOM for mutations\n    var targetNode = document.getRootNode();\n    var config = { childList: true, subtree: true };\n    var observer = new MutationObserver(onDomChange);\n    observer.observe(targetNode, config);\n}\n// Maxiumum one call per DOM change.\nvar previousDomChangeType = null;\nfunction onDomChange() {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            if (currSite === StreamingSite.Netflix) {\n                if (getPageType() === PageType.Homepage) {\n                    (0, netflix_1.onNetflixHomepage)();\n                    previousDomChangeType = PageType.Homepage;\n                }\n                if (oldHref != document.location.href) {\n                    oldHref = document.location.href;\n                    if (getPageType() === PageType.Details) {\n                        (0, netflix_1.onNetflixDetailsPage)();\n                        previousDomChangeType = PageType.Details;\n                    }\n                    if (getPageType() === PageType.Watching && previousDomChangeType != PageType.Watching) {\n                        previousDomChangeType = PageType.Watching;\n                        if (lastViewedTitleHref) {\n                            (0, netflix_1.onNetflixWatchPage)(lastViewedTitleHref);\n                        }\n                    }\n                }\n            }\n            // ------------------\n            if (currSite === StreamingSite.DisneyPlus) {\n                // We can't do disney plus ratings on hover on the main page\n                // this is because we don't have access to the link of the show/movie at any point, anywhere on the homepage.\n                // the most we can get is the title of the show in the current language, but that could cause issues.\n                if (getPageType() === PageType.Homepage && previousDomChangeType != PageType.Homepage) {\n                    previousDomChangeType = PageType.Homepage;\n                    lastViewedTitleHref = null;\n                }\n                // We can only load the rating on the details screen.\n                if (getPageType() === PageType.Details && lastViewedTitleHref != window.location.href) {\n                    previousDomChangeType = PageType.Details;\n                    lastViewedTitleHref = window.location.href;\n                    (0, disney_1.onDisneyDetailsScreen)();\n                }\n                if (getPageType() === PageType.Watching && previousDomChangeType != PageType.Watching) {\n                    previousDomChangeType = PageType.Watching;\n                    if (lastViewedTitleHref) {\n                        (0, disney_1.onDisneyWatchPage)(lastViewedTitleHref);\n                    }\n                }\n            }\n            // ------------------\n            if (currSite === StreamingSite.HBOMax) {\n                if (getPageType() === PageType.Homepage) {\n                    previousDomChangeType = PageType.Homepage;\n                    (0, hbo_1.onHBOHomepage)();\n                }\n                if (getPageType() === PageType.Details && lastViewedTitleHref != window.location.href) {\n                    previousDomChangeType = PageType.Details;\n                    lastViewedTitleHref = window.location.href;\n                    (0, hbo_1.onHBODetailsScreen)();\n                }\n                if (getPageType() === PageType.Watching && previousDomChangeType != PageType.Watching) {\n                    previousDomChangeType = PageType.Watching;\n                    \"\";\n                    (0, hbo_1.onHBOWatchPage)(lastViewedTitleHref);\n                }\n            }\n            return [2 /*return*/];\n        });\n    });\n}\nfunction getPageType() {\n    var currPage = PageType.None;\n    if (currSite === StreamingSite.Netflix) {\n        if (window.location.href.indexOf(\"browse?jbv\") > -1) {\n            currPage = PageType.Details;\n        }\n        else if (window.location.href.indexOf(\"watch\") > -1) {\n            currPage = PageType.Watching;\n        }\n        else {\n            currPage = PageType.Homepage;\n        }\n    }\n    if (currSite === StreamingSite.DisneyPlus) {\n        if (window.location.href.indexOf(\"home\") > -1) {\n            currPage = PageType.Homepage;\n        }\n        else if (/.*\\/(movies|series)\\/.*\\/.*/.test(window.location.href)) {\n            currPage = PageType.Details;\n        }\n        else if (window.location.href.indexOf(\"video\") > -1) {\n            currPage = PageType.Watching;\n        }\n        else {\n            currPage = PageType.None;\n        }\n    }\n    if (currSite === StreamingSite.HBOMax) {\n        if (window.location.href.indexOf(\"player\") > -1) {\n            currPage = PageType.Watching;\n        }\n        else if (window.location.href.indexOf(\":type:series\") > -1\n            || window.location.href.indexOf(\":type:feature\") > -1) {\n            currPage = PageType.Details;\n        }\n        else if (window.location.href.indexOf(\"/page/urn:hbo:page:\") > -1\n            || window.location.href.indexOf(\":collection:\") > -1\n            || window.location.href.indexOf(\":franchise:\") > -1) {\n            currPage = PageType.Homepage;\n        }\n        else {\n            currPage = PageType.None;\n        }\n    }\n    return currPage;\n}\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.onDisneyWatchPage = exports.onDisneyDetailsScreen = void 0;\nvar utils_1 = require(\"../../utils/utils\");\nfunction onDisneyDetailsScreen() {\n    return __awaiter(this, void 0, void 0, function () {\n        var titleHref, ratings, ratingsElement, attempts, parent_1;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    titleHref = window.location.href;\n                    return [4 /*yield*/, (0, utils_1.getRatings)({ id: titleHref })];\n                case 1:\n                    ratings = _a.sent();\n                    ratingsElement = document.createElement(\"h4\");\n                    ratingsElement.className = \"text-color--primary body-copy body-copy--large margin--left-4\";\n                    ratingsElement.innerHTML = \"IMDb: <span style=\\\"color:\".concat(ratings.imdb_color, \"\\\">\").concat(ratings.imdb_rating, \"</span> \\u00A0 Rotten Tomatoes: <span style=\\\"color:\").concat(ratings.rt_color, \"\\\">\").concat(ratings.rt_rating, \"</span>\");\n                    attempts = 0;\n                    _a.label = 2;\n                case 2:\n                    if (!true) return [3 /*break*/, 6];\n                    parent_1 = document.getElementsByClassName(\"button-play\");\n                    if (!parent_1.length) return [3 /*break*/, 3];\n                    parent_1[0].parentElement.appendChild(ratingsElement);\n                    return [3 /*break*/, 6];\n                case 3:\n                    attempts += 1;\n                    return [4 /*yield*/, (0, utils_1.delay)(100)];\n                case 4:\n                    _a.sent();\n                    _a.label = 5;\n                case 5:\n                    if (attempts === 100) {\n                        console.error(\"Failed to get ratings!\");\n                    }\n                    return [3 /*break*/, 2];\n                case 6: return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.onDisneyDetailsScreen = onDisneyDetailsScreen;\nfunction onDisneyWatchPage(titleHref) {\n    return __awaiter(this, void 0, void 0, function () {\n        var spliceIndex, episodeID, limit, endTime, startTime, durationString, durationSeconds, start, end;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    spliceIndex = window.location.href.indexOf(\"video/\") + \"video/\".length;\n                    episodeID = window.location.href.slice(spliceIndex);\n                    limit = 0;\n                    (0, utils_1.getRatings)({ id: titleHref, episode: episodeID, click: true });\n                    _a.label = 1;\n                case 1:\n                    if (!(!document.getElementsByTagName('video').length || !document.getElementsByClassName('time-remaining-label').length || limit > 50)) return [3 /*break*/, 3];\n                    limit += 1;\n                    return [4 /*yield*/, (0, utils_1.delay)(500)];\n                case 2:\n                    _a.sent();\n                    return [3 /*break*/, 1];\n                case 3:\n                    startTime = document.getElementsByTagName('video')[0].currentTime;\n                    durationString = document.getElementsByClassName('time-remaining-label')[0].textContent; // e.g 01:50:01\n                    durationSeconds = hmsToSecondsOnly(durationString);\n                    _a.label = 4;\n                case 4:\n                    if (!(window.location.href.indexOf(\"video/\".concat(episodeID)) > 0)) return [3 /*break*/, 6];\n                    try {\n                        if (window.location.href.indexOf(\"video/\".concat(episodeID)) > 0) {\n                            if (!isNaN(document.getElementsByTagName('video')[0].currentTime)) {\n                                endTime = document.getElementsByTagName('video')[0].currentTime;\n                            }\n                        }\n                    }\n                    catch (_b) {\n                        return [3 /*break*/, 6];\n                    }\n                    return [4 /*yield*/, (0, utils_1.delay)(10)];\n                case 5:\n                    _a.sent();\n                    return [3 /*break*/, 4];\n                case 6:\n                    start = Math.floor((startTime / durationSeconds) * 100);\n                    end = Math.floor((endTime / durationSeconds) * 100);\n                    (0, utils_1.getRatings)({ id: titleHref, episode: episodeID, click: true, start: start, end: end });\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.onDisneyWatchPage = onDisneyWatchPage;\nfunction hmsToSecondsOnly(str) {\n    var part = str.split(':'), seconds = 0, minutes = 1;\n    while (part.length > 0) {\n        seconds += minutes * parseInt(part.pop(), 10);\n        minutes *= 60;\n    }\n    return seconds;\n}\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getHBOTitleHref = exports.onHBOWatchPage = exports.onHBODetailsScreen = exports.onHBOHomepage = void 0;\nvar utils_1 = require(\"../../utils/utils\");\nvar lastHoveredTitleHfref = null;\nfunction onHBOHomepage() {\n    return __awaiter(this, void 0, void 0, function () {\n        var titleHref;\n        return __generator(this, function (_a) {\n            titleHref = getHBOTitleHref();\n            // Makes sure we only load once per element\n            if (lastHoveredTitleHfref != titleHref) {\n                lastHoveredTitleHfref = titleHref;\n                if (titleHref) {\n                    handleTitleCardHover();\n                }\n            }\n            return [2 /*return*/];\n        });\n    });\n}\nexports.onHBOHomepage = onHBOHomepage;\nfunction onHBODetailsScreen() {\n    return __awaiter(this, void 0, void 0, function () {\n        var titleHref, ratings, ratingsElement, attempts, buttonContainers, index;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    titleHref = window.location.href.slice(0, window.location.href.indexOf(\":type:\"));\n                    return [4 /*yield*/, (0, utils_1.getRatings)({ id: titleHref })];\n                case 1:\n                    ratings = _a.sent();\n                    ratingsElement = document.createElement(\"h2\");\n                    ratingsElement.className = \"ratings css-1rynq56 r-dnmrzs r-1udh08x r-1udbk01 r-3s2u2q r-1iln25a\";\n                    ratingsElement.innerHTML = \"IMDb: <span style=\\\"color:\".concat(ratings.imdb_color, \"\\\">\").concat(ratings.imdb_rating, \"</span> \\u00A0 Rotten Tomatoes: <span style=\\\"color:\").concat(ratings.rt_color, \"\\\">\").concat(ratings.rt_rating, \"</span>\");\n                    ratingsElement.setAttribute('style', 'color: rgba(255, 255, 255, 0.7); font-family: StreetLCG2; font-weight: 400; font-style: normal; font-size: 14px; letter-spacing: 0.5px; line-height: 18px; padding-left:20px');\n                    attempts = 0;\n                    _a.label = 2;\n                case 2:\n                    if (!true) return [3 /*break*/, 7];\n                    return [4 /*yield*/, (0, utils_1.delay)(1000)];\n                case 3:\n                    _a.sent();\n                    buttonContainers = document.getElementsByClassName('css-175oi2r r-1awozwy r-18u37iz r-1mnahxq');\n                    if (!buttonContainers.length) return [3 /*break*/, 4];\n                    for (index = 0; index < buttonContainers.length; index++) {\n                        if (getComputedStyle(buttonContainers[index]).display == 'flex') {\n                            buttonContainers[index].appendChild(ratingsElement);\n                            fadeIn(ratingsElement, 0.1);\n                        }\n                    }\n                    return [3 /*break*/, 7];\n                case 4:\n                    attempts += 1;\n                    return [4 /*yield*/, (0, utils_1.delay)(100)];\n                case 5:\n                    _a.sent();\n                    _a.label = 6;\n                case 6:\n                    if (attempts === 100) {\n                        console.error(\"Failed to get ratings!\");\n                    }\n                    return [3 /*break*/, 2];\n                case 7: return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.onHBODetailsScreen = onHBODetailsScreen;\nfunction onHBOWatchPage(titleHref) {\n    return __awaiter(this, void 0, void 0, function () {\n        var spliceIndex, episodeID, exitPageUrn, limit, endTime, startTime, duration, start, end;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    if (titleHref.indexOf(\"?exitPageUrn\") > 0) {\n                        titleHref = titleHref.slice(0, titleHref.indexOf(\"?exitPageUrn\"));\n                    }\n                    spliceIndex = window.location.href.indexOf(\":episode:\") + \":episode:\".length;\n                    if (spliceIndex == 8) {\n                        spliceIndex = window.location.href.indexOf(\":feature:\") + \":feature:\".length;\n                    }\n                    episodeID = window.location.href.slice(spliceIndex, spliceIndex + 21);\n                    exitPageUrn = null;\n                    if (window.location.href.indexOf('?exitPageUrn=') > 0 && window.location.href.indexOf('episode') > 0) {\n                        exitPageUrn = window.location.href.slice(window.location.href.indexOf('?exitPageUrn=') + '?exitPageUrn='.length);\n                    }\n                    limit = 0;\n                    if (titleHref.indexOf('series') == 0) {\n                        titleHref = \"\";\n                    }\n                    else if (exitPageUrn) {\n                        titleHref = 'https://play.hbomax.com' + exitPageUrn.replace('series', 'page') + ':type:series';\n                    }\n                    (0, utils_1.getRatings)({ id: titleHref, episode: episodeID, click: true });\n                    return [4 /*yield*/, (0, utils_1.delay)(5000)];\n                case 1:\n                    _a.sent();\n                    _a.label = 2;\n                case 2:\n                    if (!(!document.getElementsByTagName('video').length || limit > 50)) return [3 /*break*/, 4];\n                    limit += 1;\n                    return [4 /*yield*/, (0, utils_1.delay)(500)];\n                case 3:\n                    _a.sent();\n                    return [3 /*break*/, 2];\n                case 4:\n                    startTime = document.getElementsByTagName('video')[0].currentTime;\n                    duration = document.getElementsByTagName('video')[0].duration;\n                    _a.label = 5;\n                case 5:\n                    if (!(window.location.href.indexOf(episodeID) > 0)) return [3 /*break*/, 7];\n                    try {\n                        if (window.location.href.indexOf(episodeID) > 0) {\n                            if (!isNaN(document.getElementsByTagName('video')[0].currentTime)) {\n                                endTime = document.getElementsByTagName('video')[0].currentTime;\n                            }\n                        }\n                    }\n                    catch (error) {\n                        console.log(error);\n                        return [3 /*break*/, 7];\n                    }\n                    return [4 /*yield*/, (0, utils_1.delay)(10)];\n                case 6:\n                    _a.sent();\n                    return [3 /*break*/, 5];\n                case 7:\n                    start = Math.floor((startTime / duration) * 100);\n                    end = Math.floor((endTime / duration) * 100);\n                    if (isNaN(start)) {\n                        console.log('Got NAN for start');\n                        start = 0;\n                    }\n                    if (isNaN(end)) {\n                        console.log('Got NAN for end');\n                        end = 0;\n                    }\n                    (0, utils_1.getRatings)({ id: titleHref, episode: episodeID, click: true, start: start, end: end });\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.onHBOWatchPage = onHBOWatchPage;\nfunction handleTitleCardHover() {\n    return __awaiter(this, void 0, void 0, function () {\n        var hoveredTitleCard, ratings, titleHref, error_1, ratingsElement, inserted, index;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    hoveredTitleCard = Array.from(document.querySelectorAll(\":hover\")).pop().closest('a');\n                    if (!(hoveredTitleCard.parentElement.querySelectorAll(\".ratings-loader,.ratings\").length == 0\n                        && hoveredTitleCard.href.includes(':type:')\n                        && !(hoveredTitleCard.href.includes('episode')))) return [3 /*break*/, 5];\n                    (0, utils_1.addLoader)(hoveredTitleCard.children[0].children[0], 0.75);\n                    ratings = { rt_rating: 'N/A', imdb_rating: 'N/A', imdb_color: \"#FFF\", rt_color: \"#FFF\" };\n                    titleHref = getHBOTitleHref();\n                    _a.label = 1;\n                case 1:\n                    _a.trys.push([1, 3, , 4]);\n                    return [4 /*yield*/, (0, utils_1.getRatings)({ id: titleHref })];\n                case 2:\n                    ratings = _a.sent();\n                    return [3 /*break*/, 4];\n                case 3:\n                    error_1 = _a.sent();\n                    console.log(error_1);\n                    return [3 /*break*/, 4];\n                case 4:\n                    ratingsElement = document.createElement(\"h2\");\n                    ratingsElement.className = \"ratings css-1rynq56 r-dnmrzs r-1udh08x r-1udbk01 r-3s2u2q r-1iln25a\";\n                    ratingsElement.innerHTML = \"IMDb: <span style=\\\"color:\".concat(ratings.imdb_color, \"\\\">\").concat(ratings.imdb_rating, \"</span> \\u00A0 Rotten Tomatoes: <span style=\\\"color:\").concat(ratings.rt_color, \"\\\">\").concat(ratings.rt_rating, \"</span>\");\n                    ratingsElement.setAttribute('style', 'color: rgba(255, 255, 255, 0.7); font-family: StreetLCG2; font-weight: 400; font-style: normal; font-size: 12px; letter-spacing: 0.5px; line-height: 18px;');\n                    (0, utils_1.removeLoader)(hoveredTitleCard.children[0].children[0]);\n                    // Insert ratings element if not a trailer\n                    if (!hoveredTitleCard.href.includes('extra')) {\n                        inserted = false;\n                        for (index = 0; index < hoveredTitleCard.children.length; index++) {\n                            if (hoveredTitleCard.children[index].getAttribute('data-testid') == 'attribution-text'\n                                || hoveredTitleCard.children[index].getAttribute('data-testid') == 'tile-details-container') {\n                                hoveredTitleCard.insertBefore(ratingsElement, hoveredTitleCard.children[index]);\n                                inserted = true;\n                            }\n                        }\n                        if (!inserted) {\n                            hoveredTitleCard.appendChild(ratingsElement);\n                        }\n                        fadeIn(ratingsElement, 0.1);\n                    }\n                    _a.label = 5;\n                case 5: return [2 /*return*/];\n            }\n        });\n    });\n}\nfunction fadeIn(item, i) {\n    i += 0.2;\n    item.style.opacity = i;\n    if (i < 1)\n        setTimeout(function () { return fadeIn(item, i); }, 50);\n}\nfunction getHBOTitleHref() {\n    var hoveredTitleCard = Array.from(document.querySelectorAll(\":hover\")).pop();\n    try {\n        var titleHref = hoveredTitleCard.closest('a').href;\n        return titleHref.slice(0, titleHref.indexOf(\":type:\"));\n    }\n    catch (TypeError) {\n        return null;\n    }\n}\nexports.getHBOTitleHref = getHBOTitleHref;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getAlternateTitleHref = exports.getNetflixTitleHref = exports.onNetflixWatchPage = exports.onNetflixDetailsPage = exports.onNetflixHomepage = void 0;\nvar utils_1 = require(\"../../utils/utils\");\nvar lastGrabbedRatingsFromTitleCard = null;\nvar lastViewedTitleHref = null;\nfunction onNetflixHomepage() {\n    return __awaiter(this, void 0, void 0, function () {\n        var titleHref;\n        return __generator(this, function (_a) {\n            titleHref = getNetflixTitleHref();\n            if (lastViewedTitleHref != titleHref) {\n                lastViewedTitleHref = titleHref;\n                if (titleHref) {\n                    handleTitleCardHover(lastViewedTitleHref);\n                }\n            }\n            return [2 /*return*/];\n        });\n    });\n}\nexports.onNetflixHomepage = onNetflixHomepage;\nfunction onNetflixDetailsPage() {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            if (lastViewedTitleHref)\n                handleShowInformationCard(lastViewedTitleHref);\n            else {\n                lastViewedTitleHref = getAlternateTitleHref();\n                if (lastViewedTitleHref)\n                    handleShowInformationCard(lastViewedTitleHref);\n            }\n            return [2 /*return*/];\n        });\n    });\n}\nexports.onNetflixDetailsPage = onNetflixDetailsPage;\nfunction onNetflixWatchPage(titleHref) {\n    return __awaiter(this, void 0, void 0, function () {\n        var spliceIndex, episodeID, limit, endTime, startTime, duration, start, end;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    spliceIndex = window.location.href.indexOf(\"watch/\") + \"watch/\".length;\n                    episodeID = window.location.href.slice(spliceIndex, spliceIndex + 8);\n                    limit = 0;\n                    (0, utils_1.getRatings)({ id: titleHref, episode: episodeID, click: true });\n                    _a.label = 1;\n                case 1:\n                    if (!(!document.getElementsByTagName('video').length || limit > 50)) return [3 /*break*/, 3];\n                    limit += 1;\n                    return [4 /*yield*/, (0, utils_1.delay)(500)];\n                case 2:\n                    _a.sent();\n                    return [3 /*break*/, 1];\n                case 3:\n                    startTime = document.getElementsByTagName('video')[0].currentTime;\n                    duration = document.getElementsByTagName('video')[0].duration;\n                    _a.label = 4;\n                case 4:\n                    if (!(window.location.href.indexOf(\"watch/\".concat(episodeID)) > 0)) return [3 /*break*/, 6];\n                    try {\n                        if (window.location.href.indexOf(\"watch/\".concat(episodeID)) > 0) {\n                            if (!isNaN(document.getElementsByTagName('video')[0].currentTime)) {\n                                endTime = document.getElementsByTagName('video')[0].currentTime;\n                            }\n                        }\n                    }\n                    catch (_b) {\n                        return [3 /*break*/, 6];\n                    }\n                    return [4 /*yield*/, (0, utils_1.delay)(10)];\n                case 5:\n                    _a.sent();\n                    return [3 /*break*/, 4];\n                case 6:\n                    start = Math.floor((startTime / duration) * 100);\n                    end = Math.floor((endTime / duration) * 100);\n                    (0, utils_1.getRatings)({ id: titleHref, episode: episodeID, click: true, start: start, end: end });\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.onNetflixWatchPage = onNetflixWatchPage;\nfunction handleShowInformationCard(titleHref) {\n    return __awaiter(this, void 0, void 0, function () {\n        var parent, ratings, ratingsElement;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    parent = document.getElementsByClassName(\"detail-modal-container\")[0];\n                    (0, utils_1.addLoader)(parent, /*number=*/ 1, /*insertBefore=*/ true);\n                    if (!(!lastGrabbedRatingsFromTitleCard || lastGrabbedRatingsFromTitleCard.id != titleHref)) return [3 /*break*/, 2];\n                    return [4 /*yield*/, (0, utils_1.getRatings)({ id: titleHref, click: true })];\n                case 1:\n                    ratings = _a.sent();\n                    lastGrabbedRatingsFromTitleCard = ratings;\n                    lastGrabbedRatingsFromTitleCard.id = titleHref;\n                    return [3 /*break*/, 3];\n                case 2:\n                    // Use cached ratings if we have them.\n                    ratings = lastGrabbedRatingsFromTitleCard;\n                    _a.label = 3;\n                case 3:\n                    ratingsElement = document.createElement(\"span\");\n                    ratingsElement.className = \"previewModal--metadatAndControls-tags-container\";\n                    ratingsElement.innerHTML =\n                        \"\\n  <div class=\\\"evidence-tags\\\">\\n    <div class=\\\"evidence-list\\\">\\n      <div class=\\\"evidence-item\\\">\\n        <span class=\\\"evidence-text\\\" style=\\\"font-size:20px\\\">\\n          IMDb: <span style=\\\"color:\".concat(ratings.imdb_color, \"\\\">\").concat(ratings.imdb_rating, \"</span> \\n        </span>\\n      </div>\\n      <div class=\\\"evidence-item\\\">\\n        <span class=\\\"evidence-separator\\\"></span>\\n        <span class=\\\"evidence-text\\\" style=\\\"font-size:20px\\\">\\n          Rotten Tomatoes: <span style=\\\"color:\").concat(ratings.rt_color, \"\\\">\").concat(ratings.rt_rating, \"</span> \\n        </span>\\n      </div>\\n    </div>\\n  </div>\\n  \");\n                    (0, utils_1.removeLoader)(parent);\n                    parent.insertBefore(ratingsElement, parent.children[0]);\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nfunction handleTitleCardHover(titleHref) {\n    return __awaiter(this, void 0, void 0, function () {\n        var parent, ratings, ratingsElement;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    parent = document.getElementsByClassName(\"previewModal--metadatAndControls-container\")[0];\n                    (0, utils_1.addLoader)(parent);\n                    return [4 /*yield*/, (0, utils_1.getRatings)({ id: titleHref })];\n                case 1:\n                    ratings = _a.sent();\n                    lastGrabbedRatingsFromTitleCard = ratings;\n                    lastGrabbedRatingsFromTitleCard.id = titleHref;\n                    ratingsElement = document.createElement(\"span\");\n                    ratingsElement.className = \"previewModal--metadatAndControls-tags-container\";\n                    ratingsElement.innerHTML =\n                        \"\\n  <div class=\\\"evidence-tags\\\">\\n    <div class=\\\"evidence-list\\\">\\n      <div class=\\\"evidence-item\\\">\\n        <span class=\\\"evidence-text\\\">\\n          IMDb: <span style=\\\"color:\".concat(ratings.imdb_color, \"\\\">\").concat(ratings.imdb_rating, \"</span> \\n        </span>\\n      </div>\\n      <div class=\\\"evidence-item\\\">\\n        <span class=\\\"evidence-separator\\\"></span>\\n        <span class=\\\"evidence-text\\\">\\n          Rotten Tomatoes: <span style=\\\"color:\").concat(ratings.rt_color, \"\\\">\").concat(ratings.rt_rating, \"</span> \\n        </span>\\n      </div>\\n    </div>\\n  </div>\\n  \");\n                    (0, utils_1.removeLoader)(parent);\n                    insertBeforeProgressBar(ratingsElement, parent);\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nfunction insertBeforeProgressBar(element, parent) {\n    var progressBar = parent.getElementsByClassName(\"previewModal-progress\")[0];\n    if (progressBar) {\n        parent.insertBefore(element, progressBar);\n    }\n    else\n        parent.appendChild(element);\n}\nfunction getNetflixTitleHref() {\n    var previewModal = document.getElementsByClassName(\"previewModal--info\")[0];\n    try {\n        var titleHref = previewModal.children[0].href;\n        return titleHref.slice(0, titleHref.indexOf(\"/title/\") + \"/title/\".length + 8);\n    }\n    catch (TypeError) {\n        return null;\n    }\n}\nexports.getNetflixTitleHref = getNetflixTitleHref;\nfunction getAlternateTitleHref() {\n    if (window.location.href.indexOf(\"title\") == -1)\n        return null;\n    try {\n        var linkElements = document.querySelectorAll(\"link[rel='alternate']\");\n        var link = linkElements[0].href;\n        if (!link)\n            return null;\n        return \"https://\" + link.slice(link.indexOf(\"www.netflix\"));\n    }\n    catch (TypeError) {\n        return null;\n    }\n}\nexports.getAlternateTitleHref = getAlternateTitleHref;\n","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.removeLoader = exports.addLoader = exports.delay = exports.getRatings = void 0;\nfunction getRatings(params) {\n    return __awaiter(this, void 0, void 0, function () {\n        var _a, id, episode, _b, api, click, start, end, localRating, apiUrl, request, response, _c;\n        return __generator(this, function (_d) {\n            switch (_d.label) {\n                case 0:\n                    _a = __assign({}, params), id = _a.id, episode = _a.episode, _b = _a.api, api = _b === void 0 ? \"8mds8d7d55\" : _b, click = _a.click, start = _a.start, end = _a.end;\n                    if (!!click) return [3 /*break*/, 2];\n                    return [4 /*yield*/, checkLocalStorage(id)];\n                case 1:\n                    localRating = _d.sent();\n                    if (localRating) {\n                        return [2 /*return*/, localRating];\n                    }\n                    _d.label = 2;\n                case 2:\n                    apiUrl = new URL(\"https://filmtoro.com/api/watch.asp\");\n                    apiUrl.searchParams.append('id', id);\n                    apiUrl.searchParams.append('api', api);\n                    if (typeof click !== 'undefined')\n                        apiUrl.searchParams.append('click', click.toString());\n                    if (typeof episode !== 'undefined')\n                        apiUrl.searchParams.append('episode', episode);\n                    if (typeof start !== 'undefined')\n                        apiUrl.searchParams.append('start', start.toString());\n                    if (typeof end !== 'undefined')\n                        apiUrl.searchParams.append('end', end.toString());\n                    return [4 /*yield*/, fetch(apiUrl)];\n                case 3:\n                    request = _d.sent();\n                    _c = formatApiData;\n                    return [4 /*yield*/, request.json()];\n                case 4:\n                    response = _c.apply(void 0, [_d.sent()]);\n                    return [4 /*yield*/, addToLocalStorage(id, response)];\n                case 5:\n                    _d.sent();\n                    return [2 /*return*/, response];\n            }\n        });\n    });\n}\nexports.getRatings = getRatings;\nfunction checkLocalStorage(titleHref) {\n    return __awaiter(this, void 0, void 0, function () {\n        var localStorage;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, chrome.storage.local.get([\"previous_ratings\"])];\n                case 1:\n                    localStorage = _a.sent();\n                    if (!localStorage.previous_ratings) {\n                        return [2 /*return*/, null];\n                    }\n                    else {\n                        if (localStorage.previous_ratings[titleHref]) {\n                            return [2 /*return*/, localStorage.previous_ratings[titleHref]];\n                        }\n                        return [2 /*return*/, null];\n                    }\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nfunction addToLocalStorage(titleHref, rating) {\n    return __awaiter(this, void 0, void 0, function () {\n        var initial_ratings, result;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    initial_ratings = {};\n                    return [4 /*yield*/, chrome.storage.local.get([\"previous_ratings\"])];\n                case 1:\n                    result = _a.sent();\n                    if (!!result.previous_ratings) return [3 /*break*/, 3];\n                    // If we have not stored previous ratings before\n                    initial_ratings[titleHref] = rating;\n                    return [4 /*yield*/, chrome.storage.local.set({\n                            previous_ratings: initial_ratings\n                        })];\n                case 2:\n                    _a.sent();\n                    return [3 /*break*/, 5];\n                case 3:\n                    if (!!(titleHref in result.previous_ratings)) return [3 /*break*/, 5];\n                    // If we have stored ratings and it's not already stored\n                    result.previous_ratings[titleHref] = rating;\n                    return [4 /*yield*/, chrome.storage.local.set({\n                            previous_ratings: result.previous_ratings,\n                        })];\n                case 4:\n                    _a.sent();\n                    _a.label = 5;\n                case 5: return [2 /*return*/];\n            }\n        });\n    });\n}\nfunction formatApiData(apiData) {\n    var output = { rt_rating: 'N/A', imdb_rating: 'N/A', imdb_color: \"#FFF\", rt_color: \"#FFF\" };\n    if (apiData['film_imdb_rating'] > 0) {\n        output.imdb_rating = \"\".concat((apiData['film_imdb_rating'] / 10).toFixed(1));\n        if (apiData['film_imdb_rating'] > 83) {\n            output.imdb_color = '#2ECC71';\n        }\n        else if (apiData['film_imdb_rating'] < 70) {\n            output.imdb_color = '#C70039';\n        }\n    }\n    if (apiData['film_rt_rating'] > 0) {\n        output.rt_rating = \"\".concat(apiData['film_rt_rating'], \"%\");\n        if (apiData['film_rt_rating'] > 83) {\n            output.rt_color = '#2ECC71';\n        }\n        else if (apiData['film_rt_rating'] < 70) {\n            output.rt_color = '#C70039';\n        }\n    }\n    return output;\n}\nfunction delay(time) {\n    return new Promise(function (resolve) { return setTimeout(resolve, time); });\n}\nexports.delay = delay;\nfunction addLoader(parent, scale, insertBefore) {\n    if (scale === void 0) { scale = 1; }\n    if (insertBefore === void 0) { insertBefore = false; }\n    var loader = document.createElement(\"div\");\n    loader.className = \"ratings-loader\";\n    loader.innerHTML = \"\\n\\n  <div class=\\\"loadingio-spinner-rolling-mhlz99gyu8k\\\"><div class=\\\"ldio-ma7aqaeb3ij\\\">\\n  <div></div>\\n  </div></div>\\n  <style type=\\\"text/css\\\">\\n  @keyframes ldio-ma7aqaeb3ij {\\n    0% { transform: translate(-50%,-50%) rotate(0deg); }\\n    100% { transform: translate(-50%,-50%) rotate(360deg); }\\n  }\\n  .ldio-ma7aqaeb3ij div {\\n    position: absolute;\\n    width: 120px;\\n    height: 120px;\\n    border: 10px solid #ffffff;\\n    border-top-color: transparent;\\n    border-radius: 50%;\\n  }\\n  .ldio-ma7aqaeb3ij div {\\n    animation: ldio-ma7aqaeb3ij 1s linear infinite;\\n    top: 100px;\\n    left: 100px\\n  }\\n  .loadingio-spinner-rolling-mhlz99gyu8k {\\n    width: 50px;\\n    height: 50px;\\n    display: inline-block;\\n    overflow: hidden;\\n  }\\n  .ldio-ma7aqaeb3ij {\\n    width: 100%;\\n    height: 100%;\\n    position: relative;\\n    transform: translateZ(0) scale(0.25);\\n    backface-visibility: hidden;\\n    transform-origin: 0 0px; /* see note above */\\n  }\\n  .ldio-ma7aqaeb3ij div { box-sizing: content-box; }\\n\\n  .ratings-loader {\\n    display: flex;\\n    justify-content: center;\\n  }\\n\\n  </style>\\n  \";\n    loader.setAttribute('style', \"transform: scale(\".concat(scale, \");\"));\n    if (insertBefore) {\n        parent.insertBefore(loader, parent.children[0]);\n    }\n    else {\n        parent.appendChild(loader);\n    }\n}\nexports.addLoader = addLoader;\nfunction removeLoader(parent) {\n    var loader = parent.getElementsByClassName(\"ratings-loader\")[0];\n    parent.removeChild(loader);\n}\nexports.removeLoader = removeLoader;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(607);\n",""],"names":[],"sourceRoot":""}