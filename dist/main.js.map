{"version":3,"file":"main.js","mappings":";;;;;;;AAAa;AACb;AACA,4BAA4B,+DAA+D,iBAAiB;AAC5G;AACA,oCAAoC,MAAM,+BAA+B,YAAY;AACrF,mCAAmC,MAAM,mCAAmC,YAAY;AACxF,gCAAgC;AAChC;AACA,KAAK;AACL;AACA;AACA,cAAc,6BAA6B,0BAA0B,cAAc,qBAAqB;AACxG,iBAAiB,oDAAoD,qEAAqE,cAAc;AACxJ,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC,mCAAmC,SAAS;AAC5C,mCAAmC,WAAW,UAAU;AACxD,0CAA0C,cAAc;AACxD;AACA,8GAA8G,OAAO;AACrH,iFAAiF,iBAAiB;AAClG,yDAAyD,gBAAgB,QAAQ;AACjF,+CAA+C,gBAAgB,gBAAgB;AAC/E;AACA,kCAAkC;AAClC;AACA;AACA,UAAU,YAAY,aAAa,SAAS,UAAU;AACtD,oCAAoC,SAAS;AAC7C;AACA;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,eAAe,mBAAO,CAAC,GAAiB;AACxC,gBAAgB,mBAAO,CAAC,GAAiB;AACzC,YAAY,mBAAO,CAAC,GAAa;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,sCAAsC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,4BAA4B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AChMa;AACb;AACA,4BAA4B,+DAA+D,iBAAiB;AAC5G;AACA,oCAAoC,MAAM,+BAA+B,YAAY;AACrF,mCAAmC,MAAM,mCAAmC,YAAY;AACxF,gCAAgC;AAChC;AACA,KAAK;AACL;AACA;AACA,cAAc,6BAA6B,0BAA0B,cAAc,qBAAqB;AACxG,iBAAiB,oDAAoD,qEAAqE,cAAc;AACxJ,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC,mCAAmC,SAAS;AAC5C,mCAAmC,WAAW,UAAU;AACxD,0CAA0C,cAAc;AACxD;AACA,8GAA8G,OAAO;AACrH,iFAAiF,iBAAiB;AAClG,yDAAyD,gBAAgB,QAAQ;AACjF,+CAA+C,gBAAgB,gBAAgB;AAC/E;AACA,kCAAkC;AAClC;AACA;AACA,UAAU,YAAY,aAAa,SAAS,UAAU;AACtD,oCAAoC,SAAS;AAC7C;AACA;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,yBAAyB,GAAG,6BAA6B;AACzD,cAAc,mBAAO,CAAC,GAAmB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,eAAe;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,KAAK,EAAE,EAAwB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,gDAAgD;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6GAA6G;AAC7G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,wEAAwE;AACtH;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACtIa;AACb;AACA,4BAA4B,+DAA+D,iBAAiB;AAC5G;AACA,oCAAoC,MAAM,+BAA+B,YAAY;AACrF,mCAAmC,MAAM,mCAAmC,YAAY;AACxF,gCAAgC;AAChC;AACA,KAAK;AACL;AACA;AACA,cAAc,6BAA6B,0BAA0B,cAAc,qBAAqB;AACxG,iBAAiB,oDAAoD,qEAAqE,cAAc;AACxJ,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC,mCAAmC,SAAS;AAC5C,mCAAmC,WAAW,UAAU;AACxD,0CAA0C,cAAc;AACxD;AACA,8GAA8G,OAAO;AACrH,iFAAiF,iBAAiB;AAClG,yDAAyD,gBAAgB,QAAQ;AACjF,+CAA+C,gBAAgB,gBAAgB;AAC/E;AACA,kCAAkC;AAClC;AACA;AACA,UAAU,YAAY,aAAa,SAAS,UAAU;AACtD,oCAAoC,SAAS;AAC7C;AACA;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,uBAAuB,GAAG,sBAAsB,GAAG,0BAA0B,GAAG,qBAAqB;AACrG,cAAc,mBAAO,CAAC,GAAmB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,eAAe;AAClF;AACA;AACA;AACA;AACA;AACA,2FAA2F,yBAAyB,kBAAkB,oBAAoB,iBAAiB,uBAAuB,mBAAmB;AACrN;AACA;AACA;AACA,wBAAwB,KAAK,EAAE,EAAwB;AACvD;AACA;AACA;AACA;AACA;AACA,oCAAoC,iCAAiC;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,gDAAgD;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,wEAAwE;AACtH;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA,mEAAmE,eAAe;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2FAA2F,yBAAyB,kBAAkB,oBAAoB,iBAAiB,uBAAuB,kBAAkB;AACpN;AACA;AACA;AACA;AACA,wCAAwC,0CAA0C;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,iCAAiC,yBAAyB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;;;;;;;;ACxPV;AACb;AACA,4BAA4B,+DAA+D,iBAAiB;AAC5G;AACA,oCAAoC,MAAM,+BAA+B,YAAY;AACrF,mCAAmC,MAAM,mCAAmC,YAAY;AACxF,gCAAgC;AAChC;AACA,KAAK;AACL;AACA;AACA,cAAc,6BAA6B,0BAA0B,cAAc,qBAAqB;AACxG,iBAAiB,oDAAoD,qEAAqE,cAAc;AACxJ,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC,mCAAmC,SAAS;AAC5C,mCAAmC,WAAW,UAAU;AACxD,0CAA0C,cAAc;AACxD;AACA,8GAA8G,OAAO;AACrH,iFAAiF,iBAAiB;AAClG,yDAAyD,gBAAgB,QAAQ;AACjF,+CAA+C,gBAAgB,gBAAgB;AAC/E;AACA,kCAAkC;AAClC;AACA;AACA,UAAU,YAAY,aAAa,SAAS,UAAU;AACtD,oCAAoC,SAAS;AAC7C;AACA;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,2BAA2B,GAAG,0BAA0B,GAAG,yBAAyB;AACpF,cAAc,mBAAO,CAAC,GAAmB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,gDAAgD;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,wEAAwE;AACtH;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,eAAe;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;;;;;;;;AClJd;AACb;AACA;AACA,iDAAiD,OAAO;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,+DAA+D,iBAAiB;AAC5G;AACA,oCAAoC,MAAM,+BAA+B,YAAY;AACrF,mCAAmC,MAAM,mCAAmC,YAAY;AACxF,gCAAgC;AAChC;AACA,KAAK;AACL;AACA;AACA,cAAc,6BAA6B,0BAA0B,cAAc,qBAAqB;AACxG,iBAAiB,oDAAoD,qEAAqE,cAAc;AACxJ,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC,mCAAmC,SAAS;AAC5C,mCAAmC,WAAW,UAAU;AACxD,0CAA0C,cAAc;AACxD;AACA,8GAA8G,OAAO;AACrH,iFAAiF,iBAAiB;AAClG,yDAAyD,gBAAgB,QAAQ;AACjF,+CAA+C,gBAAgB,gBAAgB;AAC/E;AACA,kCAAkC;AAClC;AACA;AACA,UAAU,YAAY,aAAa,SAAS,UAAU;AACtD,oCAAoC,SAAS;AAC7C;AACA;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,oBAAoB,GAAG,iBAAiB,GAAG,aAAa,GAAG,kBAAkB;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,mCAAmC;AAC/E;AACA,aAAa;AACb;AACA,4BAA4B;AAC5B;AACA;AACA,gNAAgN,WAAW,+CAA+C,aAAa,iDAAiD,KAAK,2BAA2B,yBAAyB,mBAAmB,oBAAoB,iCAAiC,oCAAoC,yBAAyB,KAAK,2BAA2B,qDAAqD,iBAAiB,sBAAsB,4CAA4C,kBAAkB,mBAAmB,4BAA4B,uBAAuB,KAAK,uBAAuB,kBAAkB,mBAAmB,yBAAyB,2CAA2C,kCAAkC,+BAA+B,yBAAyB,4BAA4B,0BAA0B,uBAAuB,oBAAoB,8BAA8B,KAAK;AACzmC,sEAAsE;AACtE;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,oBAAoB;;;;;;;UC5LpB;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;UEtBA;UACA;UACA;UACA","sources":["webpack://imdb-rt-streaming/./src/index.ts","webpack://imdb-rt-streaming/./src/sites/disney+/index.ts","webpack://imdb-rt-streaming/./src/sites/hbo/index.ts","webpack://imdb-rt-streaming/./src/sites/netflix/index.ts","webpack://imdb-rt-streaming/./src/utils/utils.ts","webpack://imdb-rt-streaming/webpack/bootstrap","webpack://imdb-rt-streaming/webpack/before-startup","webpack://imdb-rt-streaming/webpack/startup","webpack://imdb-rt-streaming/webpack/after-startup"],"sourcesContent":["\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar disney_1 = require(\"./sites/disney+\");\r\nvar netflix_1 = require(\"./sites/netflix\");\r\nvar hbo_1 = require(\"./sites/hbo\");\r\nvar StreamingSite;\r\n(function (StreamingSite) {\r\n    StreamingSite[StreamingSite[\"Netflix\"] = 0] = \"Netflix\";\r\n    StreamingSite[StreamingSite[\"DisneyPlus\"] = 1] = \"DisneyPlus\";\r\n    StreamingSite[StreamingSite[\"HBOMax\"] = 2] = \"HBOMax\";\r\n    StreamingSite[StreamingSite[\"None\"] = 3] = \"None\";\r\n})(StreamingSite || (StreamingSite = {}));\r\nvar PageType;\r\n(function (PageType) {\r\n    PageType[PageType[\"Homepage\"] = 0] = \"Homepage\";\r\n    PageType[PageType[\"Details\"] = 1] = \"Details\";\r\n    PageType[PageType[\"Watching\"] = 2] = \"Watching\";\r\n    PageType[PageType[\"None\"] = 3] = \"None\";\r\n})(PageType || (PageType = {}));\r\n// clear stored ratings \r\nchrome.storage.local.clear();\r\nvar currSite = StreamingSite.None;\r\nvar lastViewedTitleHref = null;\r\nwindow.addEventListener(\"load\", onLoad);\r\nfunction onLoad(event) {\r\n    // Determine what streaming site we are on\r\n    if (window.location.href.indexOf(\"netflix.com/\") > -1) {\r\n        currSite = StreamingSite.Netflix;\r\n        window.addEventListener(\"mousedown\", function () {\r\n            if ((0, netflix_1.getNetflixTitleHref)()) {\r\n                lastViewedTitleHref = (0, netflix_1.getNetflixTitleHref)();\r\n            }\r\n        });\r\n    }\r\n    else if (window.location.href.indexOf(\"disneyplus.com/\") > -1) {\r\n        currSite = StreamingSite.DisneyPlus;\r\n    }\r\n    else if (window.location.href.indexOf(\"hbomax.com/\") > -1) {\r\n        currSite = StreamingSite.HBOMax;\r\n        window.addEventListener(\"mousedown\", function () {\r\n            if ((0, hbo_1.getHBOTitleHref)()) {\r\n                lastViewedTitleHref = (0, hbo_1.getHBOTitleHref)();\r\n            }\r\n        });\r\n    }\r\n    // Start observing the DOM for mutations\r\n    var targetNode = document.getRootNode();\r\n    var config = { childList: true, subtree: true };\r\n    var observer = new MutationObserver(onDomChange);\r\n    observer.observe(targetNode, config);\r\n}\r\n// Maxiumum one call per DOM change.\r\nvar previousDomChangeType = null;\r\nfunction onDomChange() {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        return __generator(this, function (_a) {\r\n            if (currSite === StreamingSite.Netflix) {\r\n                if (getPageType() === PageType.Homepage) {\r\n                    (0, netflix_1.onNetflixHomepage)();\r\n                    previousDomChangeType = PageType.Homepage;\r\n                }\r\n                if (getPageType() === PageType.Watching && previousDomChangeType != PageType.Watching) {\r\n                    previousDomChangeType = PageType.Watching;\r\n                    if (lastViewedTitleHref) {\r\n                        (0, netflix_1.onNetflixWatchPage)(lastViewedTitleHref);\r\n                    }\r\n                }\r\n            }\r\n            // ------------------\r\n            if (currSite === StreamingSite.DisneyPlus) {\r\n                // We can't do disney plus ratings on hover on the main page\r\n                // this is because we don't have access to the link of the show/movie at any point, anywhere on the homepage.\r\n                // the most we can get is the title of the show in the current language, but that could cause issues.\r\n                if (getPageType() === PageType.Homepage && previousDomChangeType != PageType.Homepage) {\r\n                    previousDomChangeType = PageType.Homepage;\r\n                    lastViewedTitleHref = null;\r\n                }\r\n                // We can only load the rating on the details screen.\r\n                if (getPageType() === PageType.Details && lastViewedTitleHref != window.location.href) {\r\n                    previousDomChangeType = PageType.Details;\r\n                    lastViewedTitleHref = window.location.href;\r\n                    (0, disney_1.onDisneyDetailsScreen)();\r\n                }\r\n                if (getPageType() === PageType.Watching && previousDomChangeType != PageType.Watching) {\r\n                    previousDomChangeType = PageType.Watching;\r\n                    if (lastViewedTitleHref) {\r\n                        (0, disney_1.onDisneyWatchPage)(lastViewedTitleHref);\r\n                    }\r\n                }\r\n            }\r\n            // ------------------\r\n            if (currSite === StreamingSite.HBOMax) {\r\n                if (getPageType() === PageType.Homepage) {\r\n                    previousDomChangeType = PageType.Homepage;\r\n                    (0, hbo_1.onHBOHomepage)();\r\n                }\r\n                if (getPageType() === PageType.Details && lastViewedTitleHref != window.location.href) {\r\n                    previousDomChangeType = PageType.Details;\r\n                    lastViewedTitleHref = window.location.href;\r\n                    (0, hbo_1.onHBODetailsScreen)();\r\n                }\r\n                if (getPageType() === PageType.Watching && previousDomChangeType != PageType.Watching) {\r\n                    previousDomChangeType = PageType.Watching;\r\n                    \"\";\r\n                    (0, hbo_1.onHBOWatchPage)(lastViewedTitleHref);\r\n                }\r\n            }\r\n            return [2 /*return*/];\r\n        });\r\n    });\r\n}\r\nfunction getPageType() {\r\n    var currPage = PageType.None;\r\n    if (currSite === StreamingSite.Netflix) {\r\n        if (window.location.href.indexOf(\"browse?jbv\") > -1) {\r\n            currPage = PageType.Details;\r\n        }\r\n        else if (window.location.href.indexOf(\"watch\") > -1) {\r\n            currPage = PageType.Watching;\r\n        }\r\n        else {\r\n            currPage = PageType.Homepage;\r\n        }\r\n    }\r\n    if (currSite === StreamingSite.DisneyPlus) {\r\n        if (window.location.href.indexOf(\"home\") > -1) {\r\n            currPage = PageType.Homepage;\r\n        }\r\n        else if (/.*\\/(movies|series)\\/.*\\/.*/.test(window.location.href)) {\r\n            currPage = PageType.Details;\r\n        }\r\n        else if (window.location.href.indexOf(\"video\") > -1) {\r\n            currPage = PageType.Watching;\r\n        }\r\n        else {\r\n            currPage = PageType.None;\r\n        }\r\n    }\r\n    if (currSite === StreamingSite.HBOMax) {\r\n        if (window.location.href.indexOf(\"player\") > -1) {\r\n            currPage = PageType.Watching;\r\n        }\r\n        else if (window.location.href.indexOf(\":type:series\") > -1\r\n            || window.location.href.indexOf(\":type:feature\") > -1) {\r\n            currPage = PageType.Details;\r\n        }\r\n        else if (window.location.href.indexOf(\"/page/urn:hbo:page:\") > -1\r\n            || window.location.href.indexOf(\":collection:\") > -1\r\n            || window.location.href.indexOf(\":franchise:\") > -1) {\r\n            currPage = PageType.Homepage;\r\n        }\r\n        else {\r\n            currPage = PageType.None;\r\n        }\r\n    }\r\n    return currPage;\r\n}\r\n","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.onDisneyWatchPage = exports.onDisneyDetailsScreen = void 0;\r\nvar utils_1 = require(\"../../utils/utils\");\r\nfunction onDisneyDetailsScreen() {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var titleHref, ratings, ratingsElement, attempts, parent_1;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    titleHref = window.location.href;\r\n                    return [4 /*yield*/, (0, utils_1.getRatings)({ id: titleHref })];\r\n                case 1:\r\n                    ratings = _a.sent();\r\n                    ratingsElement = document.createElement(\"h4\");\r\n                    ratingsElement.className = \"text-color--primary body-copy body-copy--large margin--left-4\";\r\n                    ratingsElement.innerHTML = \"IMDb: <span style=\\\"color:\".concat(ratings.imdb_color, \"\\\">\").concat(ratings.imdb_rating, \"</span> \\u00A0 Rotten Tomatoes: <span style=\\\"color:\").concat(ratings.rt_color, \"\\\">\").concat(ratings.rt_rating, \"</span>\");\r\n                    attempts = 0;\r\n                    _a.label = 2;\r\n                case 2:\r\n                    if (!true) return [3 /*break*/, 6];\r\n                    parent_1 = document.getElementsByClassName(\"button-play\");\r\n                    if (!parent_1.length) return [3 /*break*/, 3];\r\n                    parent_1[0].parentElement.appendChild(ratingsElement);\r\n                    return [3 /*break*/, 6];\r\n                case 3:\r\n                    attempts += 1;\r\n                    return [4 /*yield*/, (0, utils_1.delay)(100)];\r\n                case 4:\r\n                    _a.sent();\r\n                    _a.label = 5;\r\n                case 5:\r\n                    if (attempts === 100) {\r\n                        console.error(\"Failed to get ratings!\");\r\n                    }\r\n                    return [3 /*break*/, 2];\r\n                case 6: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.onDisneyDetailsScreen = onDisneyDetailsScreen;\r\nfunction onDisneyWatchPage(titleHref) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var spliceIndex, episodeID, limit, endTime, startTime, durationString, durationSeconds, start, end;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    spliceIndex = window.location.href.indexOf(\"video/\") + \"video/\".length;\r\n                    episodeID = window.location.href.slice(spliceIndex);\r\n                    limit = 0;\r\n                    (0, utils_1.getRatings)({ id: titleHref, episode: episodeID, click: true });\r\n                    _a.label = 1;\r\n                case 1:\r\n                    if (!(!document.getElementsByTagName('video').length || !document.getElementsByClassName('time-remaining-label').length || limit > 50)) return [3 /*break*/, 3];\r\n                    limit += 1;\r\n                    return [4 /*yield*/, (0, utils_1.delay)(500)];\r\n                case 2:\r\n                    _a.sent();\r\n                    return [3 /*break*/, 1];\r\n                case 3:\r\n                    startTime = document.getElementsByTagName('video')[0].currentTime;\r\n                    durationString = document.getElementsByClassName('time-remaining-label')[0].textContent; // e.g 01:50:01\r\n                    durationSeconds = hmsToSecondsOnly(durationString);\r\n                    _a.label = 4;\r\n                case 4:\r\n                    if (!(window.location.href.indexOf(\"video/\".concat(episodeID)) > 0)) return [3 /*break*/, 6];\r\n                    try {\r\n                        if (window.location.href.indexOf(\"video/\".concat(episodeID)) > 0) {\r\n                            if (!isNaN(document.getElementsByTagName('video')[0].currentTime)) {\r\n                                endTime = document.getElementsByTagName('video')[0].currentTime;\r\n                            }\r\n                        }\r\n                    }\r\n                    catch (_b) {\r\n                        return [3 /*break*/, 6];\r\n                    }\r\n                    return [4 /*yield*/, (0, utils_1.delay)(10)];\r\n                case 5:\r\n                    _a.sent();\r\n                    return [3 /*break*/, 4];\r\n                case 6:\r\n                    start = Math.floor((startTime / durationSeconds) * 100);\r\n                    end = Math.floor((endTime / durationSeconds) * 100);\r\n                    (0, utils_1.getRatings)({ id: titleHref, episode: episodeID, click: true, start: start, end: end });\r\n                    return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.onDisneyWatchPage = onDisneyWatchPage;\r\nfunction hmsToSecondsOnly(str) {\r\n    var part = str.split(':'), seconds = 0, minutes = 1;\r\n    while (part.length > 0) {\r\n        seconds += minutes * parseInt(part.pop(), 10);\r\n        minutes *= 60;\r\n    }\r\n    return seconds;\r\n}\r\n","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.getHBOTitleHref = exports.onHBOWatchPage = exports.onHBODetailsScreen = exports.onHBOHomepage = void 0;\r\nvar utils_1 = require(\"../../utils/utils\");\r\nvar lastHoveredTitleHfref = null;\r\nfunction onHBOHomepage() {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var titleHref;\r\n        return __generator(this, function (_a) {\r\n            titleHref = getHBOTitleHref();\r\n            // Makes sure we only load once per element\r\n            if (lastHoveredTitleHfref != titleHref) {\r\n                lastHoveredTitleHfref = titleHref;\r\n                if (titleHref) {\r\n                    handleTitleCardHover();\r\n                }\r\n            }\r\n            return [2 /*return*/];\r\n        });\r\n    });\r\n}\r\nexports.onHBOHomepage = onHBOHomepage;\r\nfunction onHBODetailsScreen() {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var titleHref, ratings, ratingsElement, attempts, buttonContainers, index;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    titleHref = window.location.href.slice(0, window.location.href.indexOf(\":type:\"));\r\n                    return [4 /*yield*/, (0, utils_1.getRatings)({ id: titleHref })];\r\n                case 1:\r\n                    ratings = _a.sent();\r\n                    ratingsElement = document.createElement(\"h2\");\r\n                    ratingsElement.className = \"ratings css-1rynq56 r-dnmrzs r-1udh08x r-1udbk01 r-3s2u2q r-1iln25a\";\r\n                    ratingsElement.innerHTML = \"IMDb: <span style=\\\"color:\".concat(ratings.imdb_color, \"\\\">\").concat(ratings.imdb_rating, \"</span> \\u00A0 Rotten Tomatoes: <span style=\\\"color:\").concat(ratings.rt_color, \"\\\">\").concat(ratings.rt_rating, \"</span>\");\r\n                    ratingsElement.setAttribute('style', 'color: rgba(255, 255, 255, 0.7); font-family: StreetLCG2; font-weight: 400; font-style: normal; font-size: 14px; letter-spacing: 0.5px; line-height: 18px; padding-left:20px');\r\n                    attempts = 0;\r\n                    _a.label = 2;\r\n                case 2:\r\n                    if (!true) return [3 /*break*/, 7];\r\n                    return [4 /*yield*/, (0, utils_1.delay)(1000)];\r\n                case 3:\r\n                    _a.sent();\r\n                    buttonContainers = document.getElementsByClassName('css-175oi2r r-1awozwy r-18u37iz r-1mnahxq');\r\n                    if (!buttonContainers.length) return [3 /*break*/, 4];\r\n                    for (index = 0; index < buttonContainers.length; index++) {\r\n                        if (getComputedStyle(buttonContainers[index]).display == 'flex') {\r\n                            buttonContainers[index].appendChild(ratingsElement);\r\n                            fadeIn(ratingsElement, 0.1);\r\n                        }\r\n                    }\r\n                    return [3 /*break*/, 7];\r\n                case 4:\r\n                    attempts += 1;\r\n                    return [4 /*yield*/, (0, utils_1.delay)(100)];\r\n                case 5:\r\n                    _a.sent();\r\n                    _a.label = 6;\r\n                case 6:\r\n                    if (attempts === 100) {\r\n                        console.error(\"Failed to get ratings!\");\r\n                    }\r\n                    return [3 /*break*/, 2];\r\n                case 7: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.onHBODetailsScreen = onHBODetailsScreen;\r\nfunction onHBOWatchPage(titleHref) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var spliceIndex, episodeID, exitPageUrn, limit, endTime, startTime, duration, start, end;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    if (titleHref.indexOf(\"?exitPageUrn\") > 0) {\r\n                        titleHref = titleHref.slice(0, titleHref.indexOf(\"?exitPageUrn\"));\r\n                    }\r\n                    spliceIndex = window.location.href.indexOf(\":episode:\") + \":episode:\".length;\r\n                    if (spliceIndex == 8) {\r\n                        spliceIndex = window.location.href.indexOf(\":feature:\") + \":feature:\".length;\r\n                    }\r\n                    episodeID = window.location.href.slice(spliceIndex, spliceIndex + 21);\r\n                    exitPageUrn = null;\r\n                    if (window.location.href.indexOf('?exitPageUrn=') > 0 && window.location.href.indexOf('episode') > 0) {\r\n                        exitPageUrn = window.location.href.slice(window.location.href.indexOf('?exitPageUrn=') + '?exitPageUrn='.length);\r\n                    }\r\n                    limit = 0;\r\n                    if (titleHref.indexOf('series') == 0) {\r\n                        titleHref = \"\";\r\n                    }\r\n                    else if (exitPageUrn) {\r\n                        titleHref = 'https://play.hbomax.com' + exitPageUrn.replace('series', 'page') + ':type:series';\r\n                    }\r\n                    (0, utils_1.getRatings)({ id: titleHref, episode: episodeID, click: true });\r\n                    return [4 /*yield*/, (0, utils_1.delay)(5000)];\r\n                case 1:\r\n                    _a.sent();\r\n                    _a.label = 2;\r\n                case 2:\r\n                    if (!(!document.getElementsByTagName('video').length || limit > 50)) return [3 /*break*/, 4];\r\n                    limit += 1;\r\n                    return [4 /*yield*/, (0, utils_1.delay)(500)];\r\n                case 3:\r\n                    _a.sent();\r\n                    return [3 /*break*/, 2];\r\n                case 4:\r\n                    startTime = document.getElementsByTagName('video')[0].currentTime;\r\n                    duration = document.getElementsByTagName('video')[0].duration;\r\n                    _a.label = 5;\r\n                case 5:\r\n                    if (!(window.location.href.indexOf(episodeID) > 0)) return [3 /*break*/, 7];\r\n                    try {\r\n                        if (window.location.href.indexOf(episodeID) > 0) {\r\n                            if (!isNaN(document.getElementsByTagName('video')[0].currentTime)) {\r\n                                endTime = document.getElementsByTagName('video')[0].currentTime;\r\n                            }\r\n                        }\r\n                    }\r\n                    catch (error) {\r\n                        console.log(error);\r\n                        return [3 /*break*/, 7];\r\n                    }\r\n                    return [4 /*yield*/, (0, utils_1.delay)(10)];\r\n                case 6:\r\n                    _a.sent();\r\n                    return [3 /*break*/, 5];\r\n                case 7:\r\n                    start = Math.floor((startTime / duration) * 100);\r\n                    end = Math.floor((endTime / duration) * 100);\r\n                    if (isNaN(start)) {\r\n                        console.log('Got NAN for start');\r\n                        start = 0;\r\n                    }\r\n                    if (isNaN(end)) {\r\n                        console.log('Got NAN for end');\r\n                        end = 0;\r\n                    }\r\n                    (0, utils_1.getRatings)({ id: titleHref, episode: episodeID, click: true, start: start, end: end });\r\n                    return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.onHBOWatchPage = onHBOWatchPage;\r\nfunction handleTitleCardHover() {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var hoveredTitleCard, ratings, titleHref, error_1, ratingsElement, inserted, index;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    hoveredTitleCard = Array.from(document.querySelectorAll(\":hover\")).pop().closest('a');\r\n                    if (!(hoveredTitleCard.parentElement.querySelectorAll(\".ratings-loader,.ratings\").length == 0\r\n                        && hoveredTitleCard.href.includes(':type:')\r\n                        && !(hoveredTitleCard.href.includes('episode')))) return [3 /*break*/, 5];\r\n                    (0, utils_1.addLoader)(hoveredTitleCard.children[0].children[0], 0.75);\r\n                    ratings = { rt_rating: 'N/A', imdb_rating: 'N/A', imdb_color: \"#FFF\", rt_color: \"#FFF\" };\r\n                    titleHref = getHBOTitleHref();\r\n                    _a.label = 1;\r\n                case 1:\r\n                    _a.trys.push([1, 3, , 4]);\r\n                    return [4 /*yield*/, (0, utils_1.getRatings)({ id: titleHref })];\r\n                case 2:\r\n                    ratings = _a.sent();\r\n                    return [3 /*break*/, 4];\r\n                case 3:\r\n                    error_1 = _a.sent();\r\n                    console.log(error_1);\r\n                    return [3 /*break*/, 4];\r\n                case 4:\r\n                    ratingsElement = document.createElement(\"h2\");\r\n                    ratingsElement.className = \"ratings css-1rynq56 r-dnmrzs r-1udh08x r-1udbk01 r-3s2u2q r-1iln25a\";\r\n                    ratingsElement.innerHTML = \"IMDb: <span style=\\\"color:\".concat(ratings.imdb_color, \"\\\">\").concat(ratings.imdb_rating, \"</span> \\u00A0 Rotten Tomatoes: <span style=\\\"color:\").concat(ratings.rt_color, \"\\\">\").concat(ratings.rt_rating, \"</span>\");\r\n                    ratingsElement.setAttribute('style', 'color: rgba(255, 255, 255, 0.7); font-family: StreetLCG2; font-weight: 400; font-style: normal; font-size: 12px; letter-spacing: 0.5px; line-height: 18px;');\r\n                    (0, utils_1.removeLoader)(hoveredTitleCard.children[0].children[0]);\r\n                    // Insert ratings element if not a trailer\r\n                    if (!hoveredTitleCard.href.includes('extra')) {\r\n                        inserted = false;\r\n                        for (index = 0; index < hoveredTitleCard.children.length; index++) {\r\n                            if (hoveredTitleCard.children[index].getAttribute('data-testid') == 'attribution-text'\r\n                                || hoveredTitleCard.children[index].getAttribute('data-testid') == 'tile-details-container') {\r\n                                hoveredTitleCard.insertBefore(ratingsElement, hoveredTitleCard.children[index]);\r\n                                inserted = true;\r\n                            }\r\n                        }\r\n                        if (!inserted) {\r\n                            hoveredTitleCard.appendChild(ratingsElement);\r\n                        }\r\n                        fadeIn(ratingsElement, 0.1);\r\n                    }\r\n                    _a.label = 5;\r\n                case 5: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nfunction fadeIn(item, i) {\r\n    i += 0.2;\r\n    item.style.opacity = i;\r\n    if (i < 1)\r\n        setTimeout(function () { return fadeIn(item, i); }, 50);\r\n}\r\nfunction getHBOTitleHref() {\r\n    var hoveredTitleCard = Array.from(document.querySelectorAll(\":hover\")).pop();\r\n    try {\r\n        var titleHref = hoveredTitleCard.closest('a').href;\r\n        return titleHref.slice(0, titleHref.indexOf(\":type:\"));\r\n    }\r\n    catch (TypeError) {\r\n        return null;\r\n    }\r\n}\r\nexports.getHBOTitleHref = getHBOTitleHref;\r\n","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.getNetflixTitleHref = exports.onNetflixWatchPage = exports.onNetflixHomepage = void 0;\r\nvar utils_1 = require(\"../../utils/utils\");\r\nvar lastViewedTitleHref = null;\r\nfunction onNetflixHomepage() {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var titleHref;\r\n        return __generator(this, function (_a) {\r\n            titleHref = getNetflixTitleHref();\r\n            if (lastViewedTitleHref != titleHref) {\r\n                lastViewedTitleHref = titleHref;\r\n                if (titleHref) {\r\n                    handleTitleCardHover();\r\n                }\r\n            }\r\n            return [2 /*return*/];\r\n        });\r\n    });\r\n}\r\nexports.onNetflixHomepage = onNetflixHomepage;\r\nfunction onNetflixWatchPage(titleHref) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var spliceIndex, episodeID, limit, endTime, startTime, duration, start, end;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    spliceIndex = window.location.href.indexOf(\"watch/\") + \"watch/\".length;\r\n                    episodeID = window.location.href.slice(spliceIndex, spliceIndex + 8);\r\n                    limit = 0;\r\n                    (0, utils_1.getRatings)({ id: titleHref, episode: episodeID, click: true });\r\n                    _a.label = 1;\r\n                case 1:\r\n                    if (!(!document.getElementsByTagName('video').length || limit > 50)) return [3 /*break*/, 3];\r\n                    limit += 1;\r\n                    return [4 /*yield*/, (0, utils_1.delay)(500)];\r\n                case 2:\r\n                    _a.sent();\r\n                    return [3 /*break*/, 1];\r\n                case 3:\r\n                    startTime = document.getElementsByTagName('video')[0].currentTime;\r\n                    duration = document.getElementsByTagName('video')[0].duration;\r\n                    _a.label = 4;\r\n                case 4:\r\n                    if (!(window.location.href.indexOf(\"watch/\".concat(episodeID)) > 0)) return [3 /*break*/, 6];\r\n                    try {\r\n                        if (window.location.href.indexOf(\"watch/\".concat(episodeID)) > 0) {\r\n                            if (!isNaN(document.getElementsByTagName('video')[0].currentTime)) {\r\n                                endTime = document.getElementsByTagName('video')[0].currentTime;\r\n                            }\r\n                        }\r\n                    }\r\n                    catch (_b) {\r\n                        return [3 /*break*/, 6];\r\n                    }\r\n                    return [4 /*yield*/, (0, utils_1.delay)(10)];\r\n                case 5:\r\n                    _a.sent();\r\n                    return [3 /*break*/, 4];\r\n                case 6:\r\n                    start = Math.floor((startTime / duration) * 100);\r\n                    end = Math.floor((endTime / duration) * 100);\r\n                    (0, utils_1.getRatings)({ id: titleHref, episode: episodeID, click: true, start: start, end: end });\r\n                    return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.onNetflixWatchPage = onNetflixWatchPage;\r\nfunction handleTitleCardHover() {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var parent, titleHref, ratings, ratingsElement;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    parent = document.getElementsByClassName(\"previewModal--metadatAndControls-container\")[0];\r\n                    (0, utils_1.addLoader)(parent);\r\n                    titleHref = getNetflixTitleHref();\r\n                    return [4 /*yield*/, (0, utils_1.getRatings)({ id: titleHref })];\r\n                case 1:\r\n                    ratings = _a.sent();\r\n                    ratingsElement = document.createElement(\"span\");\r\n                    ratingsElement.className = \"previewModal--metadatAndControls-tags-container\";\r\n                    ratingsElement.innerHTML =\r\n                        \"\\n  <div class=\\\"evidence-tags\\\">\\n    <div class=\\\"evidence-list\\\">\\n      <div class=\\\"evidence-item\\\">\\n        <span class=\\\"evidence-text\\\">\\n          IMDb: <span style=\\\"color:\".concat(ratings.imdb_color, \"\\\">\").concat(ratings.imdb_rating, \"</span> \\n        </span>\\n      </div>\\n      <div class=\\\"evidence-item\\\">\\n        <span class=\\\"evidence-separator\\\"></span>\\n        <span class=\\\"evidence-text\\\">\\n          Rotten Tomatoes: <span style=\\\"color:\").concat(ratings.rt_color, \"\\\">\").concat(ratings.rt_rating, \"</span> \\n        </span>\\n      </div>\\n    </div>\\n  </div>\\n  \");\r\n                    (0, utils_1.removeLoader)(parent);\r\n                    insertBeforeProgressBar(ratingsElement, parent);\r\n                    return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nfunction insertBeforeProgressBar(element, parent) {\r\n    var progressBar = parent.getElementsByClassName(\"previewModal-progress\")[0];\r\n    if (progressBar) {\r\n        parent.insertBefore(element, progressBar);\r\n    }\r\n    else\r\n        parent.appendChild(element);\r\n}\r\nfunction getNetflixTitleHref() {\r\n    var previewModal = document.getElementsByClassName(\"previewModal--info\")[0];\r\n    try {\r\n        var titleHref = previewModal.children[0].href;\r\n        return titleHref.slice(0, titleHref.indexOf(\"/title/\") + \"/title/\".length + 8);\r\n    }\r\n    catch (TypeError) {\r\n        return null;\r\n    }\r\n}\r\nexports.getNetflixTitleHref = getNetflixTitleHref;\r\n","\"use strict\";\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.removeLoader = exports.addLoader = exports.delay = exports.getRatings = void 0;\r\nfunction getRatings(params) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var _a, id, episode, _b, api, click, start, end, localRating, apiUrl, request, response, _c;\r\n        return __generator(this, function (_d) {\r\n            switch (_d.label) {\r\n                case 0:\r\n                    _a = __assign({}, params), id = _a.id, episode = _a.episode, _b = _a.api, api = _b === void 0 ? \"8mds8d7d55\" : _b, click = _a.click, start = _a.start, end = _a.end;\r\n                    if (!!click) return [3 /*break*/, 2];\r\n                    return [4 /*yield*/, checkLocalStorage(id)];\r\n                case 1:\r\n                    localRating = _d.sent();\r\n                    if (localRating) {\r\n                        return [2 /*return*/, localRating];\r\n                    }\r\n                    _d.label = 2;\r\n                case 2:\r\n                    apiUrl = new URL(\"https://filmtoro.com/api/watch.asp\");\r\n                    apiUrl.searchParams.append('id', id);\r\n                    apiUrl.searchParams.append('api', api);\r\n                    if (typeof click !== 'undefined')\r\n                        apiUrl.searchParams.append('click', click.toString());\r\n                    if (typeof episode !== 'undefined')\r\n                        apiUrl.searchParams.append('episode', episode);\r\n                    if (typeof start !== 'undefined')\r\n                        apiUrl.searchParams.append('start', start.toString());\r\n                    if (typeof end !== 'undefined')\r\n                        apiUrl.searchParams.append('end', end.toString());\r\n                    return [4 /*yield*/, fetch(apiUrl)];\r\n                case 3:\r\n                    request = _d.sent();\r\n                    _c = formatApiData;\r\n                    return [4 /*yield*/, request.json()];\r\n                case 4:\r\n                    response = _c.apply(void 0, [_d.sent()]);\r\n                    return [4 /*yield*/, addToLocalStorage(id, response)];\r\n                case 5:\r\n                    _d.sent();\r\n                    return [2 /*return*/, response];\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.getRatings = getRatings;\r\nfunction checkLocalStorage(titleHref) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var localStorage;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0: return [4 /*yield*/, chrome.storage.local.get([\"previous_ratings\"])];\r\n                case 1:\r\n                    localStorage = _a.sent();\r\n                    if (!localStorage.previous_ratings) {\r\n                        return [2 /*return*/, null];\r\n                    }\r\n                    else {\r\n                        if (localStorage.previous_ratings[titleHref]) {\r\n                            return [2 /*return*/, localStorage.previous_ratings[titleHref]];\r\n                        }\r\n                        return [2 /*return*/, null];\r\n                    }\r\n                    return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nfunction addToLocalStorage(titleHref, rating) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var initial_ratings, result;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    initial_ratings = {};\r\n                    return [4 /*yield*/, chrome.storage.local.get([\"previous_ratings\"])];\r\n                case 1:\r\n                    result = _a.sent();\r\n                    if (!!result.previous_ratings) return [3 /*break*/, 3];\r\n                    // If we have not stored previous ratings before\r\n                    initial_ratings[titleHref] = rating;\r\n                    return [4 /*yield*/, chrome.storage.local.set({\r\n                            previous_ratings: initial_ratings\r\n                        })];\r\n                case 2:\r\n                    _a.sent();\r\n                    return [3 /*break*/, 5];\r\n                case 3:\r\n                    if (!!(titleHref in result.previous_ratings)) return [3 /*break*/, 5];\r\n                    // If we have stored ratings and it's not already stored\r\n                    result.previous_ratings[titleHref] = rating;\r\n                    return [4 /*yield*/, chrome.storage.local.set({\r\n                            previous_ratings: result.previous_ratings,\r\n                        })];\r\n                case 4:\r\n                    _a.sent();\r\n                    _a.label = 5;\r\n                case 5: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nfunction formatApiData(apiData) {\r\n    var output = { rt_rating: 'N/A', imdb_rating: 'N/A', imdb_color: \"#FFF\", rt_color: \"#FFF\" };\r\n    if (apiData['film_imdb_rating'] > 0) {\r\n        output.imdb_rating = \"\".concat((apiData['film_imdb_rating'] / 10).toFixed(1));\r\n        if (apiData['film_imdb_rating'] > 83) {\r\n            output.imdb_color = '#2ECC71';\r\n        }\r\n        else if (apiData['film_imdb_rating'] < 70) {\r\n            output.imdb_color = '#C70039';\r\n        }\r\n    }\r\n    if (apiData['film_rt_rating'] > 0) {\r\n        output.rt_rating = \"\".concat(apiData['film_rt_rating'], \"%\");\r\n        if (apiData['film_rt_rating'] > 83) {\r\n            output.rt_color = '#2ECC71';\r\n        }\r\n        else if (apiData['film_rt_rating'] < 70) {\r\n            output.rt_color = '#C70039';\r\n        }\r\n    }\r\n    return output;\r\n}\r\nfunction delay(time) {\r\n    return new Promise(function (resolve) { return setTimeout(resolve, time); });\r\n}\r\nexports.delay = delay;\r\nfunction addLoader(parent, scale) {\r\n    if (scale === void 0) { scale = 1; }\r\n    var loader = document.createElement(\"div\");\r\n    loader.className = \"ratings-loader\";\r\n    loader.innerHTML = \"\\n\\n  <div class=\\\"loadingio-spinner-rolling-mhlz99gyu8k\\\"><div class=\\\"ldio-ma7aqaeb3ij\\\">\\n  <div></div>\\n  </div></div>\\n  <style type=\\\"text/css\\\">\\n  @keyframes ldio-ma7aqaeb3ij {\\n    0% { transform: translate(-50%,-50%) rotate(0deg); }\\n    100% { transform: translate(-50%,-50%) rotate(360deg); }\\n  }\\n  .ldio-ma7aqaeb3ij div {\\n    position: absolute;\\n    width: 120px;\\n    height: 120px;\\n    border: 10px solid #ffffff;\\n    border-top-color: transparent;\\n    border-radius: 50%;\\n  }\\n  .ldio-ma7aqaeb3ij div {\\n    animation: ldio-ma7aqaeb3ij 1s linear infinite;\\n    top: 100px;\\n    left: 100px\\n  }\\n  .loadingio-spinner-rolling-mhlz99gyu8k {\\n    width: 50px;\\n    height: 50px;\\n    display: inline-block;\\n    overflow: hidden;\\n  }\\n  .ldio-ma7aqaeb3ij {\\n    width: 100%;\\n    height: 100%;\\n    position: relative;\\n    transform: translateZ(0) scale(0.25);\\n    backface-visibility: hidden;\\n    transform-origin: 0 0px; /* see note above */\\n  }\\n  .ldio-ma7aqaeb3ij div { box-sizing: content-box; }\\n\\n  .ratings-loader {\\n    display: flex;\\n    justify-content: center;\\n  }\\n\\n  </style>\\n  \";\r\n    loader.setAttribute('style', \"transform: scale(\".concat(scale, \");\"));\r\n    parent.appendChild(loader);\r\n}\r\nexports.addLoader = addLoader;\r\nfunction removeLoader(parent) {\r\n    var loader = parent.getElementsByClassName(\"ratings-loader\")[0];\r\n    parent.removeChild(loader);\r\n}\r\nexports.removeLoader = removeLoader;\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(607);\n",""],"names":[],"sourceRoot":""}