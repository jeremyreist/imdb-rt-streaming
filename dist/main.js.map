{"version":3,"file":"main.js","mappings":";;;;;;;AAAa;AACb;AACA,4BAA4B,+DAA+D,iBAAiB;AAC5G;AACA,oCAAoC,MAAM,+BAA+B,YAAY;AACrF,mCAAmC,MAAM,mCAAmC,YAAY;AACxF,gCAAgC;AAChC;AACA,KAAK;AACL;AACA;AACA,cAAc,6BAA6B,0BAA0B,cAAc,qBAAqB;AACxG,iBAAiB,oDAAoD,qEAAqE,cAAc;AACxJ,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC,mCAAmC,SAAS;AAC5C,mCAAmC,WAAW,UAAU;AACxD,0CAA0C,cAAc;AACxD;AACA,8GAA8G,OAAO;AACrH,iFAAiF,iBAAiB;AAClG,yDAAyD,gBAAgB,QAAQ;AACjF,+CAA+C,gBAAgB,gBAAgB;AAC/E;AACA,kCAAkC;AAClC;AACA;AACA,UAAU,YAAY,aAAa,SAAS,UAAU;AACtD,oCAAoC,SAAS;AAC7C;AACA;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,eAAe,mBAAO,CAAC,GAAiB;AACxC,gBAAgB,mBAAO,CAAC,GAAiB;AACzC,cAAc,mBAAO,CAAC,GAAe;AACrC;AACA;AACA;AACA;AACA;AACA,CAAC,sCAAsC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,4BAA4B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC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A;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,mCAAmC;AAC/E;AACA,aAAa;AACb;AACA;AACA;AACA,gNAAgN,WAAW,+CAA+C,aAAa,iDAAiD,KAAK,2BAA2B,yBAAyB,mBAAmB,oBAAoB,iCAAiC,oCAAoC,yBAAyB,KAAK,2BAA2B,qDAAqD,iBAAiB,sBAAsB,4CAA4C,kBAAkB,mBAAmB,4BAA4B,uBAAuB,KAAK,uBAAuB,kBAAkB,mBAAmB,yBAAyB,2CAA2C,kCAAkC,+BAA+B,yBAAyB,4BAA4B,0BAA0B,uBAAuB,oBAAoB,8BAA8B,KAAK;AACzmC;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,oBAAoB;;;;;;;UC5KpB;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;UEtBA;UACA;UACA;UACA","sources":["webpack://imdb-rt-streaming/./src/index.ts","webpack://imdb-rt-streaming/./src/sites/disney+/index.ts","webpack://imdb-rt-streaming/./src/sites/netflix/index.ts","webpack://imdb-rt-streaming/./src/utils/utils.ts","webpack://imdb-rt-streaming/webpack/bootstrap","webpack://imdb-rt-streaming/webpack/before-startup","webpack://imdb-rt-streaming/webpack/startup","webpack://imdb-rt-streaming/webpack/after-startup"],"sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar disney_1 = require(\"./sites/disney+\");\nvar netflix_1 = require(\"./sites/netflix\");\nvar utils_1 = require(\"./utils/utils\");\nvar StreamingSite;\n(function (StreamingSite) {\n    StreamingSite[StreamingSite[\"Netflix\"] = 0] = \"Netflix\";\n    StreamingSite[StreamingSite[\"DisneyPlus\"] = 1] = \"DisneyPlus\";\n    StreamingSite[StreamingSite[\"None\"] = 2] = \"None\";\n})(StreamingSite || (StreamingSite = {}));\nvar PageType;\n(function (PageType) {\n    PageType[PageType[\"Homepage\"] = 0] = \"Homepage\";\n    PageType[PageType[\"Details\"] = 1] = \"Details\";\n    PageType[PageType[\"Watching\"] = 2] = \"Watching\";\n    PageType[PageType[\"None\"] = 3] = \"None\";\n})(PageType || (PageType = {}));\n// clear stored ratings \nchrome.storage.local.clear();\nvar currSite = StreamingSite.None;\nvar lastViewedTitleHref = null;\nwindow.addEventListener(\"load\", onLoad);\nfunction onLoad(event) {\n    // Determine what streaming site we are on\n    if (window.location.href.indexOf(\"https://www.netflix.com/\") > -1) {\n        currSite = StreamingSite.Netflix;\n        window.addEventListener(\"mousedown\", function () {\n            if ((0, netflix_1.getTitleHref)()) {\n                lastViewedTitleHref = (0, netflix_1.getTitleHref)();\n            }\n        });\n    }\n    else if (window.location.href.indexOf(\"https://www.disneyplus.com/\") > -1) {\n        currSite = StreamingSite.DisneyPlus;\n    }\n    // Start observing the DOM for mutations\n    var targetNode = document.getRootNode();\n    var config = { childList: true, subtree: true };\n    var observer = new MutationObserver(onDomChange);\n    observer.observe(targetNode, config);\n}\n// Maxiumum one call per DOM change.\nvar previousDomChangeType = null;\nfunction onDomChange() {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            if (currSite === StreamingSite.Netflix) {\n                if (getPageType() === PageType.Homepage) {\n                    (0, netflix_1.onNetflixHomepage)();\n                    previousDomChangeType = PageType.Homepage;\n                }\n                if (getPageType() === PageType.Watching && previousDomChangeType != PageType.Watching) {\n                    previousDomChangeType = PageType.Watching;\n                    if (lastViewedTitleHref) {\n                        (0, utils_1.getRatings)(lastViewedTitleHref, true);\n                    }\n                }\n            }\n            if (currSite === StreamingSite.DisneyPlus) {\n                // We can't to disney plus ratings on hover on the main page\n                // this is because we don't have access to the link of the show/movie at any point, anywhere on the homepage.\n                // the most we can get is the title of the show in the current language, but that could cause issues.\n                if (getPageType() === PageType.Homepage && previousDomChangeType != PageType.Homepage) {\n                    previousDomChangeType = PageType.Homepage;\n                    lastViewedTitleHref = null;\n                }\n                // We can only load the rating on the details screen.\n                if (getPageType() === PageType.Details && lastViewedTitleHref != window.location.href) {\n                    previousDomChangeType = PageType.Details;\n                    lastViewedTitleHref = window.location.href;\n                    (0, disney_1.onDisneyDetailsScreen)();\n                }\n                if (getPageType() === PageType.Watching && previousDomChangeType != PageType.Watching) {\n                    previousDomChangeType = PageType.Watching;\n                    if (lastViewedTitleHref) {\n                        (0, utils_1.getRatings)(lastViewedTitleHref, true);\n                    }\n                }\n            }\n            return [2 /*return*/];\n        });\n    });\n}\nfunction getPageType() {\n    var currPage = PageType.None;\n    if (currSite === StreamingSite.Netflix) {\n        if (window.location.href.indexOf(\"browse?jbv\") > -1) {\n            currPage = PageType.Details;\n        }\n        else if (window.location.href.indexOf(\"watch\") > -1) {\n            currPage = PageType.Watching;\n        }\n        else {\n            currPage = PageType.Homepage;\n        }\n    }\n    if (currSite === StreamingSite.DisneyPlus) {\n        if (window.location.href.indexOf(\"home\") > -1) {\n            currPage = PageType.Homepage;\n        }\n        else if (/.*\\/(movies|series)\\/.*\\/.*/.test(window.location.href)) {\n            currPage = PageType.Details;\n        }\n        else if (window.location.href.indexOf(\"video\") > -1) {\n            currPage = PageType.Watching;\n        }\n        else {\n            currPage = PageType.None;\n        }\n    }\n    return currPage;\n}\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.onDisneyDetailsScreen = void 0;\nvar utils_1 = require(\"../../utils/utils\");\nfunction onDisneyDetailsScreen() {\n    return __awaiter(this, void 0, void 0, function () {\n        var titleHref, ratings, ratingsElement, attempts, parent_1;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    titleHref = window.location.href;\n                    return [4 /*yield*/, (0, utils_1.getRatings)(titleHref, false)];\n                case 1:\n                    ratings = _a.sent();\n                    ratingsElement = document.createElement(\"h4\");\n                    ratingsElement.className = \"text-color--primary body-copy body-copy--large margin--left-4\";\n                    ratingsElement.innerHTML = \"IMDb: <span style=\\\"color:\".concat(ratings.imdb_color, \"\\\">\").concat(ratings.imdb_rating, \"</span> \\u00A0 Rotten Tomatoes: <span style=\\\"color:\").concat(ratings.rt_color, \"\\\">\").concat(ratings.rt_rating, \"</span>\");\n                    attempts = 0;\n                    _a.label = 2;\n                case 2:\n                    if (!true) return [3 /*break*/, 6];\n                    parent_1 = document.getElementsByClassName(\"button-play\");\n                    if (!parent_1.length) return [3 /*break*/, 3];\n                    parent_1[0].parentElement.appendChild(ratingsElement);\n                    return [3 /*break*/, 6];\n                case 3:\n                    attempts += 1;\n                    return [4 /*yield*/, (0, utils_1.delay)(100)];\n                case 4:\n                    _a.sent();\n                    _a.label = 5;\n                case 5:\n                    if (attempts === 100) {\n                        console.error(\"Failed to get ratings!\");\n                    }\n                    return [3 /*break*/, 2];\n                case 6: return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.onDisneyDetailsScreen = onDisneyDetailsScreen;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getTitleHref = exports.onNetflixHomepage = void 0;\nvar utils_1 = require(\"../../utils/utils\");\nvar lastViewedTitleHref = null;\nfunction onNetflixHomepage() {\n    return __awaiter(this, void 0, void 0, function () {\n        var titleHref;\n        return __generator(this, function (_a) {\n            titleHref = getTitleHref();\n            if (lastViewedTitleHref != titleHref) {\n                lastViewedTitleHref = titleHref;\n                if (titleHref) {\n                    handleTitleCardHover();\n                }\n            }\n            return [2 /*return*/];\n        });\n    });\n}\nexports.onNetflixHomepage = onNetflixHomepage;\nfunction handleTitleCardHover() {\n    return __awaiter(this, void 0, void 0, function () {\n        var parent, titleHref, ratings, ratingsElement;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    parent = document.getElementsByClassName(\"previewModal--metadatAndControls-container\")[0];\n                    (0, utils_1.addLoader)(parent);\n                    titleHref = getTitleHref();\n                    return [4 /*yield*/, (0, utils_1.getRatings)(titleHref, false)];\n                case 1:\n                    ratings = _a.sent();\n                    ratingsElement = document.createElement(\"span\");\n                    ratingsElement.className = \"previewModal--metadatAndControls-tags-container\";\n                    ratingsElement.innerHTML =\n                        \"\\n  <div class=\\\"evidence-tags\\\">\\n    <div class=\\\"evidence-list\\\">\\n      <div class=\\\"evidence-item\\\">\\n        <span class=\\\"evidence-text\\\">\\n          IMDb: <span style=\\\"color:\".concat(ratings.imdb_color, \"\\\">\").concat(ratings.imdb_rating, \"</span> \\n        </span>\\n      </div>\\n      <div class=\\\"evidence-item\\\">\\n        <span class=\\\"evidence-separator\\\"></span>\\n        <span class=\\\"evidence-text\\\">\\n          Rotten Tomatoes: <span style=\\\"color:\").concat(ratings.rt_color, \"\\\">\").concat(ratings.rt_rating, \"</span> \\n        </span>\\n      </div>\\n    </div>\\n  </div>\\n  \");\n                    (0, utils_1.removeLoader)(parent);\n                    insertBeforeProgressBar(ratingsElement, parent);\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nfunction insertBeforeProgressBar(element, parent) {\n    var progressBar = parent.getElementsByClassName(\"previewModal-progress\")[0];\n    if (progressBar) {\n        parent.insertBefore(element, progressBar);\n    }\n    else\n        parent.appendChild(element);\n}\nfunction getTitleHref() {\n    var previewModal = document.getElementsByClassName(\"previewModal--info\")[0];\n    try {\n        var titleHref = previewModal.children[0].href;\n        return titleHref.slice(0, titleHref.indexOf(\"/title/\") + \"/title/\".length + 8);\n    }\n    catch (TypeError) {\n        return null;\n    }\n}\nexports.getTitleHref = getTitleHref;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.removeLoader = exports.addLoader = exports.delay = exports.getRatings = void 0;\nfunction getRatings(titleHref, hasClicked) {\n    return __awaiter(this, void 0, void 0, function () {\n        var localRating, request, response, _a, request, response, _b;\n        return __generator(this, function (_c) {\n            switch (_c.label) {\n                case 0:\n                    if (!!hasClicked) return [3 /*break*/, 5];\n                    return [4 /*yield*/, checkLocalStorage(titleHref)];\n                case 1:\n                    localRating = _c.sent();\n                    if (localRating) {\n                        return [2 /*return*/, localRating];\n                    }\n                    return [4 /*yield*/, fetch(\"https://filmtoro.com/api/watch.asp?id=\".concat(titleHref, \"&api=8mds8d7d55\"))];\n                case 2:\n                    request = _c.sent();\n                    _a = formatApiData;\n                    return [4 /*yield*/, request.json()];\n                case 3:\n                    response = _a.apply(void 0, [_c.sent()]);\n                    return [4 /*yield*/, addToLocalStorage(titleHref, response)];\n                case 4:\n                    _c.sent();\n                    return [2 /*return*/, response];\n                case 5: return [4 /*yield*/, fetch(\"https://filmtoro.com/api/watch.asp?id=\".concat(titleHref, \"&api=8mds8d7d55&click=true\"))];\n                case 6:\n                    request = _c.sent();\n                    _b = formatApiData;\n                    return [4 /*yield*/, request.json()];\n                case 7:\n                    response = _b.apply(void 0, [_c.sent()]);\n                    return [4 /*yield*/, addToLocalStorage(titleHref, response)];\n                case 8:\n                    _c.sent();\n                    return [2 /*return*/, response];\n            }\n        });\n    });\n}\nexports.getRatings = getRatings;\nfunction checkLocalStorage(titleHref) {\n    return __awaiter(this, void 0, void 0, function () {\n        var localStorage;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, chrome.storage.local.get([\"previous_ratings\"])];\n                case 1:\n                    localStorage = _a.sent();\n                    if (!localStorage.previous_ratings) {\n                        return [2 /*return*/, null];\n                    }\n                    else {\n                        if (localStorage.previous_ratings[titleHref]) {\n                            return [2 /*return*/, localStorage.previous_ratings[titleHref]];\n                        }\n                        return [2 /*return*/, null];\n                    }\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nfunction addToLocalStorage(titleHref, rating) {\n    return __awaiter(this, void 0, void 0, function () {\n        var initial_ratings, result;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    initial_ratings = {};\n                    return [4 /*yield*/, chrome.storage.local.get([\"previous_ratings\"])];\n                case 1:\n                    result = _a.sent();\n                    if (!!result.previous_ratings) return [3 /*break*/, 3];\n                    // If we have not stored previous ratings before\n                    initial_ratings[titleHref] = rating;\n                    return [4 /*yield*/, chrome.storage.local.set({\n                            previous_ratings: initial_ratings\n                        })];\n                case 2:\n                    _a.sent();\n                    return [3 /*break*/, 5];\n                case 3:\n                    if (!!(titleHref in result.previous_ratings)) return [3 /*break*/, 5];\n                    // If we have stored ratings and it's not already stored\n                    result.previous_ratings[titleHref] = rating;\n                    return [4 /*yield*/, chrome.storage.local.set({\n                            previous_ratings: result.previous_ratings,\n                        })];\n                case 4:\n                    _a.sent();\n                    _a.label = 5;\n                case 5: return [2 /*return*/];\n            }\n        });\n    });\n}\nfunction formatApiData(apiData) {\n    var output = { rt_rating: 'N/A', imdb_rating: 'N/A', imdb_color: \"#FFF\", rt_color: \"#FFF\" };\n    if (apiData['film_imdb_rating'] > 0) {\n        output.imdb_rating = \"\".concat((apiData['film_imdb_rating'] / 10).toFixed(1));\n        if (apiData['film_imdb_rating'] > 83) {\n            output.imdb_color = '#2ECC71';\n        }\n        else if (apiData['film_imdb_rating'] < 70) {\n            output.imdb_color = '#C70039';\n        }\n    }\n    if (apiData['film_rt_rating'] > 0) {\n        output.rt_rating = \"\".concat(apiData['film_rt_rating'], \"%\");\n        if (apiData['film_rt_rating'] > 83) {\n            output.rt_color = '#2ECC71';\n        }\n        else if (apiData['film_rt_rating'] < 70) {\n            output.rt_color = '#C70039';\n        }\n    }\n    return output;\n}\nfunction delay(time) {\n    return new Promise(function (resolve) { return setTimeout(resolve, time); });\n}\nexports.delay = delay;\nfunction addLoader(parent) {\n    var loader = document.createElement(\"div\");\n    loader.className = \"ratings-loader\";\n    loader.innerHTML = \"\\n\\n  <div class=\\\"loadingio-spinner-rolling-mhlz99gyu8k\\\"><div class=\\\"ldio-ma7aqaeb3ij\\\">\\n  <div></div>\\n  </div></div>\\n  <style type=\\\"text/css\\\">\\n  @keyframes ldio-ma7aqaeb3ij {\\n    0% { transform: translate(-50%,-50%) rotate(0deg); }\\n    100% { transform: translate(-50%,-50%) rotate(360deg); }\\n  }\\n  .ldio-ma7aqaeb3ij div {\\n    position: absolute;\\n    width: 120px;\\n    height: 120px;\\n    border: 10px solid #ffffff;\\n    border-top-color: transparent;\\n    border-radius: 50%;\\n  }\\n  .ldio-ma7aqaeb3ij div {\\n    animation: ldio-ma7aqaeb3ij 1s linear infinite;\\n    top: 100px;\\n    left: 100px\\n  }\\n  .loadingio-spinner-rolling-mhlz99gyu8k {\\n    width: 50px;\\n    height: 50px;\\n    display: inline-block;\\n    overflow: hidden;\\n  }\\n  .ldio-ma7aqaeb3ij {\\n    width: 100%;\\n    height: 100%;\\n    position: relative;\\n    transform: translateZ(0) scale(0.25);\\n    backface-visibility: hidden;\\n    transform-origin: 0 0px; /* see note above */\\n  }\\n  .ldio-ma7aqaeb3ij div { box-sizing: content-box; }\\n\\n  .ratings-loader {\\n    display: flex;\\n    justify-content: center;\\n  }\\n\\n  </style>\\n  \";\n    parent.appendChild(loader);\n}\nexports.addLoader = addLoader;\nfunction removeLoader(parent) {\n    var loader = parent.getElementsByClassName(\"ratings-loader\")[0];\n    parent.removeChild(loader);\n}\nexports.removeLoader = removeLoader;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(607);\n",""],"names":[],"sourceRoot":""}