{"version":3,"file":"main.js","mappings":";;;;;;;AAAa;AACb;AACA,4BAA4B,+DAA+D,iBAAiB;AAC5G;AACA,oCAAoC,MAAM,+BAA+B,YAAY;AACrF,mCAAmC,MAAM,mCAAmC,YAAY;AACxF,gCAAgC;AAChC;AACA,KAAK;AACL;AACA;AACA,cAAc,6BAA6B,0BAA0B,cAAc,qBAAqB;AACxG,iBAAiB,oDAAoD,qEAAqE,cAAc;AACxJ,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC,mCAAmC,SAAS;AAC5C,mCAAmC,WAAW,UAAU;AACxD,0CAA0C,cAAc;AACxD;AACA,8GAA8G,OAAO;AACrH,iFAAiF,iBAAiB;AAClG,yDAAyD,gBAAgB,QAAQ;AACjF,+CAA+C,gBAAgB,gBAAgB;AAC/E;AACA,kCAAkC;AAClC;AACA;AACA,UAAU,YAAY,aAAa,SAAS,UAAU;AACtD,oCAAoC,SAAS;AAC7C;AACA;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,6BAA6B;AAC7B,cAAc,mBAAO,CAAC,GAAmB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,KAAK,EAAE,EAAwB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA,6BAA6B;;;;;;;;AC9EhB;AACb;AACA,4BAA4B,+DAA+D,iBAAiB;AAC5G;AACA,oCAAoC,MAAM,+BAA+B,YAAY;AACrF,mCAAmC,MAAM,mCAAmC,YAAY;AACxF,gCAAgC;AAChC;AACA,KAAK;AACL;AACA;AACA,cAAc,6BAA6B,0BAA0B,cAAc,qBAAqB;AACxG,iBAAiB,oDAAoD,qEAAqE,cAAc;AACxJ,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC,mCAAmC,SAAS;AAC5C,mCAAmC,WAAW,UAAU;AACxD,0CAA0C,cAAc;AACxD;AACA,8GAA8G,OAAO;AACrH,iFAAiF,iBAAiB;AAClG,yDAAyD,gBAAgB,QAAQ;AACjF,+CAA+C,gBAAgB,gBAAgB;AAC/E;AACA,kCAAkC;AAClC;AACA;AACA,UAAU,YAAY,aAAa,SAAS,UAAU;AACtD,oCAAoC,SAAS;AAC7C;AACA;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,aAAa,GAAG,kBAAkB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA,kBAAkB;AAClB;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,mCAAmC;AAC/E;AACA,aAAa;;;;;;;UCxFb;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;;;;ACtBa;AACb,6BAA6C,EAAE,aAAa,CAAC;AAC7D,eAAe,mBAAO,CAAC,GAAiB;AACxC;AACA;AACA;AACA;AACA;AACA,CAAC,sCAAsC;AACvC;AACA;AACA;AACA;AACA;AACA,CAAC,4BAA4B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://imdb-rt-streaming/./src/sites/disney+/index.ts","webpack://imdb-rt-streaming/./src/utils/utils.ts","webpack://imdb-rt-streaming/webpack/bootstrap","webpack://imdb-rt-streaming/./src/index.ts"],"sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.onDisneyDetailsScreen = void 0;\nvar utils_1 = require(\"../../utils/utils\");\nfunction onDisneyDetailsScreen() {\n    return __awaiter(this, void 0, void 0, function () {\n        var titleHref, ratings, header, attempts, playButtonElement;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    titleHref = window.location.href;\n                    return [4 /*yield*/, (0, utils_1.getRatings)(titleHref, false)];\n                case 1:\n                    ratings = _a.sent();\n                    console.log(ratings);\n                    header = document.createElement(\"h4\");\n                    header.className = \"text-color--primary body-copy body-copy--large margin--left-4\";\n                    header.innerHTML = \"IMDb: <span style=\\\"color:\".concat(ratings.imdb_color, \"\\\">\").concat(ratings.imdb_rating, \"</span> \\u00A0 Rotten Tomatoes: <span style=\\\"color:\").concat(ratings.rt_color, \"\\\">\").concat(ratings.rt_rating, \"</span>\");\n                    attempts = 0;\n                    _a.label = 2;\n                case 2:\n                    if (!true) return [3 /*break*/, 6];\n                    playButtonElement = document.getElementsByClassName(\"button-play\");\n                    if (!playButtonElement.length) return [3 /*break*/, 3];\n                    playButtonElement[0].parentElement.appendChild(header);\n                    return [3 /*break*/, 6];\n                case 3:\n                    attempts += 1;\n                    return [4 /*yield*/, (0, utils_1.delay)(100)];\n                case 4:\n                    _a.sent();\n                    _a.label = 5;\n                case 5:\n                    if (attempts === 100) {\n                        console.error(\"Failed to get ratings!\");\n                    }\n                    return [3 /*break*/, 2];\n                case 6: return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.onDisneyDetailsScreen = onDisneyDetailsScreen;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.delay = exports.getRatings = void 0;\nfunction getRatings(titleHref, hasClicked) {\n    return __awaiter(this, void 0, void 0, function () {\n        var request, _a, request, _b;\n        return __generator(this, function (_c) {\n            switch (_c.label) {\n                case 0:\n                    if (!!hasClicked) return [3 /*break*/, 3];\n                    return [4 /*yield*/, fetch(\"https://filmtoro.com/api/watch.asp?id=\".concat(titleHref, \"&api=8mds8d7d55\"))];\n                case 1:\n                    request = _c.sent();\n                    _a = formatApiData;\n                    return [4 /*yield*/, request.json()];\n                case 2: return [2 /*return*/, _a.apply(void 0, [_c.sent()])];\n                case 3: return [4 /*yield*/, fetch(\"https://filmtoro.com/api/watch.asp?id=\".concat(titleHref, \"&api=8mds8d7d55&click=true\"))];\n                case 4:\n                    request = _c.sent();\n                    _b = formatApiData;\n                    return [4 /*yield*/, request.json()];\n                case 5: return [2 /*return*/, _b.apply(void 0, [_c.sent()])];\n            }\n        });\n    });\n}\nexports.getRatings = getRatings;\nfunction formatApiData(apiData) {\n    var output = { rt_rating: 'N/A', imdb_rating: 'N/A', imdb_color: \"#FFF\", rt_color: \"#FFF\" };\n    if (apiData['film_imdb_rating'] > 0) {\n        output.imdb_rating = \"\".concat(apiData['film_imdb_rating'] / 10);\n        if (apiData['film_imdb_rating'] > 83) {\n            output.imdb_color = '#2ECC71';\n        }\n        else if (apiData['film_imdb_rating'] < 70) {\n            output.imdb_color = '#C70039';\n        }\n    }\n    if (apiData['film_rt_rating'] > 0) {\n        output.rt_rating = \"\".concat(apiData['film_rt_rating'], \"%\");\n        if (apiData['film_rt_rating'] > 83) {\n            output.rt_color = '#2ECC71';\n        }\n        else if (apiData['film_rt_rating'] < 70) {\n            output.rt_color = '#C70039';\n        }\n    }\n    return output;\n}\nfunction delay(time) {\n    return new Promise(function (resolve) { return setTimeout(resolve, time); });\n}\nexports.delay = delay;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar disney_1 = require(\"./sites/disney+\");\nvar StreamingSite;\n(function (StreamingSite) {\n    StreamingSite[StreamingSite[\"Netflix\"] = 0] = \"Netflix\";\n    StreamingSite[StreamingSite[\"DisneyPlus\"] = 1] = \"DisneyPlus\";\n    StreamingSite[StreamingSite[\"None\"] = 2] = \"None\";\n})(StreamingSite || (StreamingSite = {}));\nvar PageType;\n(function (PageType) {\n    PageType[PageType[\"Homepage\"] = 0] = \"Homepage\";\n    PageType[PageType[\"Details\"] = 1] = \"Details\";\n    PageType[PageType[\"None\"] = 2] = \"None\";\n})(PageType || (PageType = {}));\nvar currSite = StreamingSite.None;\nwindow.addEventListener(\"load\", onLoad);\nfunction onLoad(event) {\n    // Determine what streaming site we are on\n    if (window.location.href.indexOf(\"https://www.netflix.com/\") > -1) {\n        currSite = StreamingSite.Netflix;\n    }\n    else if (window.location.href.indexOf(\"https://www.disneyplus.com/\") > -1) {\n        currSite = StreamingSite.DisneyPlus;\n    }\n    // Start observing the DOM for mutations\n    var targetNode = document.getRootNode();\n    var config = { childList: true, subtree: true };\n    var observer = new MutationObserver(onDomChange);\n    observer.observe(targetNode, config);\n}\nvar hasLoadedDetails = false;\nfunction onDomChange(mutationList, observer) {\n    if (currSite === StreamingSite.Netflix) {\n        // do netflix trigger\n    }\n    if (currSite === StreamingSite.DisneyPlus) {\n        // We can't to disney plus ratings on hover on the main page\n        // this is because we don't have access to the link of the show/movie at any point, anywhere on the homepage.\n        // the most we can get is the title of the show in the current language, but that could cause issues.\n        // We can only load the rating on the details screen.\n        if (getPageType() === PageType.Details && !hasLoadedDetails) {\n            (0, disney_1.onDisneyDetailsScreen)();\n            hasLoadedDetails = true;\n        }\n        if (getPageType() === PageType.Homepage) {\n            hasLoadedDetails = false;\n        }\n    }\n}\nfunction getPageType() {\n    var currPage = PageType.None;\n    if (currSite = StreamingSite.DisneyPlus) {\n        if (window.location.href.indexOf(\"home\") > -1) {\n            currPage = PageType.Homepage;\n        }\n        else if (window.location.href.indexOf(\"series\") > -1 || window.location.href.indexOf(\"movie\") > -1) {\n            currPage = PageType.Details;\n        }\n        else {\n            currPage = PageType.None;\n        }\n    }\n    return currPage;\n}\n"],"names":[],"sourceRoot":""}